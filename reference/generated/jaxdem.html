
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>jaxdem &#8212; JaxDEM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=039bb74b" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/jaxdem';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="jaxdem.analysis" href="jaxdem.analysis.html" />
    <link rel="prev" title="API reference" href="../api.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">JaxDEM</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribution_guide/index.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cdelv/JaxDEM" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribution_guide/index.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cdelv/JaxDEM" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">jaxdem</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.analysis.html">jaxdem.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.bonded_forces.html">jaxdem.bonded_forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.colliders.html">jaxdem.colliders</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.domains.html">jaxdem.domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.factory.html">jaxdem.factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.forces.html">jaxdem.forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.integrators.html">jaxdem.integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.material_matchmakers.html">jaxdem.material_matchmakers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.materials.html">jaxdem.materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.minimizers.html">jaxdem.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.rl.html">jaxdem.rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.state.html">jaxdem.state</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.system.html">jaxdem.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.utils.html">jaxdem.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.writers.html">jaxdem.writers</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="jaxdem.rl.html">jaxdem.rl</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items" aria-labelledby="pst-indices-navigation-heading-2">
  <p id="pst-indices-navigation-heading-2" class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../../genindex.html"
             accesskey="I">General Index</a>
        </li>
        <li class="toctree-l1">
          <a class="reference internal" href="../../py-modindex.html">Python Module Index</a>
        </li>
  </ul>
</nav></div>
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">API reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">jaxdem</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-jaxdem">
<span id="jaxdem"></span><h1>jaxdem<a class="headerlink" href="#module-jaxdem" title="Link to this heading">#</a></h1>
<p>JaxDEM module</p>
<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.State">
<span class="property"><span class="k"><span class="pre">final</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">State</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.utils.quaternion.html#jaxdem.utils.quaternion.Quaternion" title="jaxdem.utils.quaternion.Quaternion"><span class="pre">Quaternion</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang_vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clump_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/state.html#State"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents the complete simulation state for a system of N particles in 2D or 3D.</p>
<p class="rubric">Notes</p>
<p><cite>State</cite> is designed to support various data layouts:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Single snapshot:</strong></dt><dd><p><cite>pos.shape = (N, dim)</cite> for particle properties (e.g., <cite>pos</cite>, <cite>vel</cite>, <cite>force</cite>),
and <cite>(N,)</cite> for scalar properties (e.g., <cite>rad</cite>, <cite>mass</cite>).
In this case, <cite>batch_size</cite> is 1.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Batched states:</strong></dt><dd><p><cite>pos.shape = (B, N, dim)</cite> for particle properties, and <cite>(B, N)</cite> for scalar properties.
Here, <cite>B</cite> is the batch dimension (<cite>batch_size = pos.shape[0]</cite>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Trajectories of a single simulation:</strong></dt><dd><p><cite>pos.shape = (T, N, dim)</cite> for particle properties, and <cite>(T, N)</cite> for scalar properties.
Here, <cite>T</cite> is the trajectory dimension.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Trajectories of batched states:</strong></dt><dd><p><cite>pos.shape = (B, T_1, T_2, …, T_k, N, dim)</cite> for particle properties,
and <cite>(B, T_1, T_2, …, T_k, N)</cite> for scalar properties.</p>
<ul>
<li><p>The first dimension (i.e., <cite>pos.shape[0]</cite>) is always interpreted as the <strong>batch dimension (`B`)</strong>.</p></li>
<li><dl class="simple">
<dt>All preceding leading dimensions (<cite>T_1, T_2, … T_k</cite>) are interpreted as <strong>trajectory dimensions</strong></dt><dd><p>and they are <strong>flattened at save time</strong> if there is more than 1 trajectory dimension.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The class is <cite>final</cite> and cannot be subclassed.</p>
<p class="rubric">Example</p>
<p>Creating a simple 2D state for 4 particles:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">positions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of particles (N): </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spatial dimension (dim): </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">dim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Positions: </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Creating a batched state:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batched_state</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">positions</span><span class="p">))(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch size: </span><span class="si">{</span><span class="n">batched_state</span><span class="o">.</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Positions shape: </span><span class="si">{</span><span class="n">batched_state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.pos_c">
<span class="sig-name descname"><span class="pre">pos_c</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.pos_c" title="Link to this definition">#</a></dt>
<dd><p>Array of particle center of mass positions. Shape is <cite>(…, N, dim)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.pos_p">
<span class="sig-name descname"><span class="pre">pos_p</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.pos_p" title="Link to this definition">#</a></dt>
<dd><p>Vector relative to the center of mass (pos_p = pos - pos_c) in the principal reference frame. This field should be constant. Shape is <cite>(…, N, dim)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.vel">
<span class="sig-name descname"><span class="pre">vel</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.vel" title="Link to this definition">#</a></dt>
<dd><p>Array of particle center of mass velocities. Shape is <cite>(…, N, dim)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.force">
<span class="sig-name descname"><span class="pre">force</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.force" title="Link to this definition">#</a></dt>
<dd><p>Array of particle forces. Shape is <cite>(…, N, dim)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.q">
<span class="sig-name descname"><span class="pre">q</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.utils.quaternion.html#jaxdem.utils.quaternion.Quaternion" title="jaxdem.utils.quaternion.Quaternion"><span class="pre">Quaternion</span></a></span><a class="headerlink" href="#jaxdem.State.q" title="Link to this definition">#</a></dt>
<dd><p>Quaternion representing the orientation of the particle.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.ang_vel">
<span class="sig-name descname"><span class="pre">ang_vel</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.ang_vel" title="Link to this definition">#</a></dt>
<dd><p>Array of particle center of mass angular velocities. Shape is <cite>(…, N, 1 | 3)</cite> depending on 2D or 3D simulations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.torque">
<span class="sig-name descname"><span class="pre">torque</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.torque" title="Link to this definition">#</a></dt>
<dd><p>Array of particle torques. Shape is <cite>(…, N, 1 | 3)</cite> depending on 2D or 3D simulations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.rad">
<span class="sig-name descname"><span class="pre">rad</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.rad" title="Link to this definition">#</a></dt>
<dd><p>Array of particle radii. Shape is <cite>(…, N)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.volume">
<span class="sig-name descname"><span class="pre">volume</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.volume" title="Link to this definition">#</a></dt>
<dd><p>Array of particle volumes (or areas if 2D). Shape is <cite>(…, N)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.mass">
<span class="sig-name descname"><span class="pre">mass</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.mass" title="Link to this definition">#</a></dt>
<dd><p>Array of particle masses. Shape is <cite>(…, N)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.inertia">
<span class="sig-name descname"><span class="pre">inertia</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.inertia" title="Link to this definition">#</a></dt>
<dd><p>Inertia tensor in the principal axis frame <cite>(…, N, 1 | 3)</cite> depending on 2D or 3D simulations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.clump_id">
<span class="sig-name descname"><span class="pre">clump_id</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.clump_id" title="Link to this definition">#</a></dt>
<dd><p>Array of clump identifiers. Bodies with the same clump_id are treated as part of the same rigid body. Shape is <cite>(…, N)</cite>.
IDs need to be between 0 and N.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.bond_id">
<span class="sig-name descname"><span class="pre">bond_id</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.bond_id" title="Link to this definition">#</a></dt>
<dd><p>Array of deformable particle identifiers. Spheres (nodes) with the same bond_id are treated as part of the same deformable particle
for collision masking purposes. Shape is <cite>(…, N)</cite>. IDs need to be between 0 and N.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.unique_id">
<span class="sig-name descname"><span class="pre">unique_id</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.unique_id" title="Link to this definition">#</a></dt>
<dd><p>Array of unique particle identifiers. No ID should be repeated. Shape is <cite>(…, N)</cite>. IDs need to be between 0 and N.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.mat_id">
<span class="sig-name descname"><span class="pre">mat_id</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.mat_id" title="Link to this definition">#</a></dt>
<dd><p>Array of material IDs for each particle. Shape is <cite>(…, N)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.species_id">
<span class="sig-name descname"><span class="pre">species_id</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.species_id" title="Link to this definition">#</a></dt>
<dd><p>Array of species IDs for each particle. Shape is <cite>(…, N)</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.State.fixed">
<span class="sig-name descname"><span class="pre">fixed</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.State.fixed" title="Link to this definition">#</a></dt>
<dd><p>Boolean array indicating if a particle is fixed (immobile). Shape is <cite>(…, N)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.State.N">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">N</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L168-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.N" title="Link to this definition">#</a></dt>
<dd><p>Number of particles in the state.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.State.dim">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L175-L180"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.dim" title="Link to this definition">#</a></dt>
<dd><p>Spatial dimension of the simulation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.State.shape">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">shape</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L182-L187"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the position array <code class="docutils literal notranslate"><span class="pre">pos_c</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">dim)</span></code> or <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.State.batch_size">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">batch_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L189-L194"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.batch_size" title="Link to this definition">#</a></dt>
<dd><p>Return the batch size of the state.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.State.pos">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">pos</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L196-L206"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.pos" title="Link to this definition">#</a></dt>
<dd><p>Returns the position of each sphere in the state.
<code class="docutils literal notranslate"><span class="pre">pos_c</span></code> is the center of mass and <code class="docutils literal notranslate"><span class="pre">pos_p</span></code> is the vector relative to
the center of mass in the principal reference frame, such that
<code class="docutils literal notranslate"><span class="pre">pos</span> <span class="pre">=</span> <span class="pre">pos_c</span> <span class="pre">+</span> <span class="pre">R(q)</span> <span class="pre">&#64;</span> <span class="pre">pos_p</span></code> where <code class="docutils literal notranslate"><span class="pre">R(q)</span></code> rotates <code class="docutils literal notranslate"><span class="pre">pos_p</span></code> to the
lab frame.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.State.is_valid">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">is_valid</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L208-L272"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.is_valid" title="Link to this definition">#</a></dt>
<dd><p>Check if the internal representation of the State is consistent.</p>
<p>Verifies that:</p>
<blockquote>
<div><ul class="simple">
<li><p>The spatial dimension (<cite>dim</cite>) is either 2 or 3.</p></li>
<li><p>All position-like arrays (<cite>pos_c</cite>, <cite>pos_p</cite>, <cite>vel</cite>, <cite>force</cite>) have the same shape.</p></li>
<li><p>All angular-like arrays (<cite>ang_vel</cite>, <cite>torque</cite>, <cite>inertia</cite>) have the same shape.</p></li>
<li><p>All scalar-per-particle arrays (<cite>rad</cite>, <cite>mass</cite>, <cite>clump_id</cite>, <cite>bond_id</cite>, <cite>mat_id</cite>, <cite>species_id</cite>, <cite>fixed</cite>) have a shape consistent with <cite>pos.shape[:-1]</cite>.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If any shape inconsistency is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.State.create">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.utils.html#jaxdem.utils.Quaternion" title="jaxdem.utils.Quaternion"><span class="pre">Quaternion</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang_vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clump_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><span class="pre">MaterialTable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L274-L654"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/state.html#State.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.create" title="Link to this definition">#</a></dt>
<dd><p>Factory method to create a new <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> instance.</p>
<p>This method handles default values and ensures consistent array shapes
for all state attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Array of particle center of mass positions, equivalent to state.pos_c.
Expected shape: <cite>(…, N, dim)</cite>.
If <cite>None</cite>, an empty state is created. With <cite>dim=None</cite>, shape is
<cite>(0, 0)</cite> (wildcard empty); with <cite>dim=2|3</cite>, shape is <cite>(0, dim)</cite>.</p></li>
<li><p><strong>dim</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Spatial dimension used only when <cite>pos is None</cite> to create an empty
state. Must be 2 or 3. If <cite>None</cite>, an empty state is created with
wildcard dimension semantics (it can merge with 2D or 3D states).</p></li>
<li><p><strong>pos_p</strong> (<em>jax.typing.ArrayLike</em>) – Vector relative to the center of mass (pos_p = pos - pos_c) in the
principal reference frame. This field should be constant. Shape is <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>vel</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Initial velocities of particles. If <cite>None</cite>, defaults to zeros.
Expected shape: <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>force</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Initial forces on particles. If <cite>None</cite>, defaults to zeros.
Expected shape: <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>q</strong> (<a class="reference internal" href="jaxdem.utils.html#jaxdem.utils.Quaternion" title="jaxdem.utils.Quaternion"><em>Quaternion</em></a><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – Initial particle orientations. If <cite>None</cite>, defaults to identity quaternions.
Accepted shapes: quaternion objects or arrays of shape <cite>(…, N, 4)</cite> with
components ordered as <cite>(w, x, y, z)</cite>.</p></li>
<li><p><strong>ang_vel</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Initial angular velocities of particles. If <cite>None</cite>, defaults to zeros.
Expected shape: <cite>(…, N, 1)</cite> in 2D or <cite>(…, N, 3)</cite> in 3D.</p></li>
<li><p><strong>torque</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Initial torques on particles. If <cite>None</cite>, defaults to zeros.
Expected shape: <cite>(…, N, 1)</cite> in 2D or <cite>(…, N, 3)</cite> in 3D.</p></li>
<li><p><strong>rad</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Radii of particles. If <cite>None</cite>, defaults to ones.
Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>volume</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Volume of particles (or area in 2D). If <cite>None</cite>, defaults to hypersphere volumes of the radii.
Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>mass</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Masses of particles. If <cite>None</cite>, defaults to ones. Ignored when
<cite>mat_table</cite> is provided.
Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>inertia</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Moments of inertia in the principal axes frame. If <cite>None</cite>, defaults to
solid disks (2D) or spheres (3D).
Expected shape: <cite>(…, N, 1)</cite> in 2D or <cite>(…, N, 3)</cite> in 3D.</p></li>
<li><p><strong>clump_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Unique identifiers for clumps. If <cite>None</cite>, defaults to
<code class="xref py py-func docutils literal notranslate"><span class="pre">jnp.arange()</span></code>. Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>bond_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Unique identifiers for deformable particles. If <cite>None</cite>, defaults to
<code class="xref py py-func docutils literal notranslate"><span class="pre">jnp.arange()</span></code>. Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>mat_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Material IDs for particles. If <cite>None</cite>, defaults to zeros.
Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>species_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Species IDs for particles. If <cite>None</cite>, defaults to zeros.
Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>fixed</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Boolean array indicating fixed particles. If <cite>None</cite>, defaults to all <cite>False</cite>.
Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>mat_table</strong> (<a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><em>MaterialTable</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Optional material table providing per-material densities. When provided,
the <cite>mass</cite> argument is ignored and particle masses are computed from
<cite>density</cite> and particle volume.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <cite>State</cite> instance with all attributes correctly initialized and shaped.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the created <cite>State</cite> is not valid.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Creating a 3D state for 5 particles:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_pos</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_rad</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mass</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_5_particles</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">my_pos</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="n">my_rad</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">my_mass</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of positions: </span><span class="si">{</span><span class="n">state_5_particles</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radii: </span><span class="si">{</span><span class="n">state_5_particles</span><span class="o">.</span><span class="n">rad</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.State.merge">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L656-L769"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/state.html#State.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.merge" title="Link to this definition">#</a></dt>
<dd><p>Merges multiple <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> instances into a single new <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>.</p>
<p>This method concatenates the particles from the provided state(s) onto <cite>state1</cite>.
Particle clump_ids, bond_ids, and unique_ids are shifted to ensure
uniqueness across the merged system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state1</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The first <cite>State</cite> instance. Its particles will appear first in the merged state.</p></li>
<li><p><strong>state2</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a><em> or </em><em>Sequence</em><em>[</em><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a><em>]</em>) – The second <cite>State</cite> or a list/tuple of <cite>State</cite> instances to append.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <cite>State</cite> instance containing all particles from both input states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If either input state is invalid, or if there is a mismatch in
    spatial dimension (<cite>dim</cite>) or batch size (<cite>batch_size</cite>).</p></li>
<li><p><strong>ValueError</strong> – If the resulting merged state is somehow invalid.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_a</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]),</span> <span class="n">clump_id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_b</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]]),</span> <span class="n">clump_id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merged_state</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">state_a</span><span class="p">,</span> <span class="p">[</span><span class="n">state_b</span><span class="p">,</span> <span class="n">state_b</span><span class="p">,</span> <span class="n">state_b</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merged_state</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">state_a</span><span class="p">,</span> <span class="n">state_b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merged state N: </span><span class="si">{</span><span class="n">merged_state</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Expected: 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merged state positions:</span><span class="se">\n</span><span class="si">{</span><span class="n">merged_state</span><span class="o">.</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merged state clump_ids: </span><span class="si">{</span><span class="n">merged_state</span><span class="o">.</span><span class="n">clump_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Expected: [0, 1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.State.add">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.utils.html#jaxdem.utils.Quaternion" title="jaxdem.utils.Quaternion"><span class="pre">Quaternion</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang_vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clump_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><span class="pre">MaterialTable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L771-L900"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/state.html#State.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.add" title="Link to this definition">#</a></dt>
<dd><p>Adds new particles to an existing <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> instance, returning a new <cite>State</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The existing <cite>State</cite> to which particles will be added.</p></li>
<li><p><strong>pos</strong> (<em>jax.typing.ArrayLike</em>) – Array of particle center of mass positions, equivalent to state.pos_c.
Expected shape: <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>pos_p</strong> (<em>jax.typing.ArrayLike</em>) – Vector relative to the center of mass (pos_p = pos - pos_c) in the
principal reference frame. This field should be constant. Shape is <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>vel</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Velocities of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>force</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Forces of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>q</strong> (<a class="reference internal" href="jaxdem.utils.html#jaxdem.utils.Quaternion" title="jaxdem.utils.Quaternion"><em>Quaternion</em></a><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – Initial orientations of the new particle(s). Defaults to identity quaternions.</p></li>
<li><p><strong>ang_vel</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Angular velocities of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>torque</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Torques of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>rad</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Radii of the new particle(s). Defaults to ones.</p></li>
<li><p><strong>volume</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Volume of the new particle(s) (or area in 2D). Defaults to hypersphere volumes of the radii.</p></li>
<li><p><strong>mass</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Masses of the new particle(s). Defaults to ones. Ignored when a
<cite>mat_table</cite> is provided.</p></li>
<li><p><strong>inertia</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Moments of inertia of the new particle(s). Defaults to solid disks (2D)
or spheres (3D).</p></li>
<li><p><strong>clump_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – clump_ids of the new clump(s). If <cite>None</cite>, new IDs are generated.</p></li>
<li><p><strong>bond_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Unique identifiers for deformable particles. If <cite>None</cite>, defaults to
<code class="xref py py-func docutils literal notranslate"><span class="pre">jnp.arange()</span></code>. Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>mat_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Material IDs of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>species_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Species IDs of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>fixed</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Fixed status of the new particle(s). Defaults to all <cite>False</cite>.</p></li>
<li><p><strong>mat_table</strong> (<a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><em>MaterialTable</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Optional material table providing per-material densities. When provided,
masses are computed from <cite>density</cite> and particle volume.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <cite>State</cite> instance containing all particles from the original
<cite>state</cite> plus the newly added particles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the created new particle state or the merged state is invalid.</p></li>
<li><p><strong>AssertionError</strong> – If batch size or dimension mismatch between existing state and new particles.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initial state with 4 particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original state N: </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2">, clump_ids: </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">clump_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a single new particle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_with_added_particle</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">state</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">rad</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">mass</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">]),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New state N: </span><span class="si">{</span><span class="n">state_with_added_particle</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2">, clump_ids: </span><span class="si">{</span><span class="n">state_with_added_particle</span><span class="o">.</span><span class="n">clump_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New particle position: </span><span class="si">{</span><span class="n">state_with_added_particle</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add multiple new particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_multiple_added</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">state</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">]]),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State with multiple added N: </span><span class="si">{</span><span class="n">state_multiple_added</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="s2">, clump_ids: </span><span class="si">{</span><span class="n">state_multiple_added</span><span class="o">.</span><span class="n">clump_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.State.stack">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L902-L974"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/state.html#State.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.stack" title="Link to this definition">#</a></dt>
<dd><p>Concatenates a sequence of <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> snapshots into a trajectory or batch along axis 0.</p>
<p>This method is useful for collecting simulation snapshots over time into a
single <cite>State</cite> object where the leading dimension represents time or when
preparing a batched state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>states</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a><em>]</em>) – A sequence (e.g., list, tuple) of <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> instances to be stacked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> instance where each attribute is a JAX array with an
additional leading dimension representing the stacked trajectory.
For example, if input <cite>pos</cite> was <cite>(N, dim)</cite>, output <cite>pos</cite> will be <cite>(T, N, dim)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the input <cite>states</cite> sequence is empty.
    If the stacked <cite>State</cite> is invalid.</p></li>
<li><p><strong>AssertionError</strong> – If any input state is invalid, or if there is a mismatch in
    spatial dimension (<cite>dim</cite>), batch size (<cite>batch_size</cite>), or
    number of particles (<cite>N</cite>) between the states in the sequence.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>No clump_id shifting is performed because the leading axis represents <strong>time</strong> (or another batch dimension), not new particles.</p></li>
</ul>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a sequence of 3 simple 2D snapshots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snapshot1</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]),</span> <span class="n">vel</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snapshot2</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.1</span><span class="p">]]),</span> <span class="n">vel</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snapshot3</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.2</span><span class="p">]]),</span> <span class="n">vel</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajectory_state</span> <span class="o">=</span> <span class="n">State</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">snapshot1</span><span class="p">,</span> <span class="n">snapshot2</span><span class="p">,</span> <span class="n">snapshot3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trajectory positions shape: </span><span class="si">{</span><span class="n">trajectory_state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Expected: (3, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Positions at time step 0:</span><span class="se">\n</span><span class="si">{</span><span class="n">trajectory_state</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Positions at time step 1:</span><span class="se">\n</span><span class="si">{</span><span class="n">trajectory_state</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.State.unstack">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">unstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L976-L999"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/state.html#State.unstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.unstack" title="Link to this definition">#</a></dt>
<dd><p>Split a stacked/batched <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> along the leading axis into a Python list.</p>
<p>This is the convenient inverse of <a class="reference internal" href="#jaxdem.State.stack" title="jaxdem.State.stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">State.stack()</span></code></a>:</p>
<ul class="simple">
<li><p>If <cite>stacked = State.stack([s0, s1, …])</cite>, then <cite>State.unstack(stacked)</cite> returns <cite>[s0, s1, …]</cite>.</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The split is performed along axis 0 (the leading axis).</p></li>
<li><p>A single snapshot <cite>State</cite> (e.g. <cite>pos.shape == (N, dim)</cite>) cannot be unstacked with this
method, because axis 0 would refer to particles, not snapshots.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.State.add_clump">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add_clump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.utils.quaternion.html#jaxdem.utils.quaternion.Quaternion" title="jaxdem.utils.quaternion.Quaternion"><span class="pre">Quaternion</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang_vel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">TypedNdArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/state.py#L1001-L1137"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/state.html#State.add_clump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.State.add_clump" title="Link to this definition">#</a></dt>
<dd><p>Adds a new clump consisting of multiple spheres to an existing State.
Rigid body properties (velocity, mass, material, etc.) are broadcasted
to all spheres in the new clump. The only per sphere properties that
vary in a rigid body are pos_c, pos_p, and rad.</p>
<p>TO DO: broadcast the quaternion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The existing <cite>State</cite> to which particles will be added.</p></li>
<li><p><strong>pos</strong> (<em>jax.typing.ArrayLike</em>) – Array of particle center of mass positions, equivalent to state.pos_c.
Expected shape: <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>pos_p</strong> (<em>jax.typing.ArrayLike</em>) – Vector relative to the center of mass (pos_p = pos - pos_c) in the
principal reference frame. This field should be constant. Shape is <cite>(…, N, dim)</cite>.</p></li>
<li><p><strong>vel</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Velocities of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>force</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Forces of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>q</strong> (<a class="reference internal" href="jaxdem.utils.html#jaxdem.utils.Quaternion" title="jaxdem.utils.Quaternion"><em>Quaternion</em></a><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – Initial orientations of the new particle(s). Defaults to identity quaternions.</p></li>
<li><p><strong>ang_vel</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Angular velocities of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>torque</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Torques of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>rad</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Radii of the new particle(s). Defaults to ones.</p></li>
<li><p><strong>volume</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Volume of the new particle(s) (or area in 2D). Defaults to hypersphere volumes of the radii.</p></li>
<li><p><strong>mass</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Masses of the new particle(s). Defaults to ones.</p></li>
<li><p><strong>inertia</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Moments of inertia of the new particle(s). Defaults to solid disks (2D)
or spheres (3D).</p></li>
<li><p><strong>bond_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Unique identifiers for deformable particles. If <cite>None</cite>, defaults to
<code class="xref py py-func docutils literal notranslate"><span class="pre">jnp.arange()</span></code>. Expected shape: <cite>(…, N)</cite>.</p></li>
<li><p><strong>mat_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Material IDs of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>species_id</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Species IDs of the new particle(s). Defaults to zeros.</p></li>
<li><p><strong>fixed</strong> (<em>jax.typing.ArrayLike</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Fixed status of the new particle(s). Defaults to all <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <cite>State</cite> instance containing all particles from the original
<cite>state</cite> plus the newly added particles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.System">
<span class="property"><span class="k"><span class="pre">final</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">System</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linear_integrator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.LinearIntegrator" title="jaxdem.LinearIntegrator"><span class="pre">LinearIntegrator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.LinearMinimizer" title="jaxdem.LinearMinimizer"><span class="pre">LinearMinimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_integrator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.RotationIntegrator" title="jaxdem.RotationIntegrator"><span class="pre">RotationIntegrator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.RotationMinimizer" title="jaxdem.RotationMinimizer"><span class="pre">RotationMinimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">collider</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.Collider" title="jaxdem.Collider"><span class="pre">Collider</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.Domain" title="jaxdem.Domain"><span class="pre">Domain</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.ForceManager" title="jaxdem.ForceManager"><span class="pre">ForceManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonded_force_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel"><span class="pre">BondedForceModel</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><span class="pre">ForceModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><span class="pre">MaterialTable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interact_same_bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/system.html#System"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.System" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Encapsulates the entire simulation configuration.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <cite>System</cite> object is designed to be JIT-compiled for efficient execution.</p></li>
<li><p>The <cite>System</cite> dataclass is compatible with <code class="xref py py-func docutils literal notranslate"><span class="pre">jax.jit()</span></code>, so every field should remain JAX arrays for best performance.</p></li>
</ul>
<p class="rubric">Example</p>
<p>Creating a basic 2D simulation system:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a System instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_system</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">state_shape</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">linear_integrator_type</span><span class="o">=</span><span class="s2">&quot;euler&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rotation_integrator_type</span><span class="o">=</span><span class="s2">&quot;spiral&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">collider_type</span><span class="o">=</span><span class="s2">&quot;naive&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">domain_type</span><span class="o">=</span><span class="s2">&quot;free&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">force_model_type</span><span class="o">=</span><span class="s2">&quot;spring&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># You can pass keyword arguments to component constructors via &#39;_kw&#39; dicts</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">domain_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">box_size</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]),</span> <span class="n">anchor</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System integrator: </span><span class="si">{</span><span class="n">sim_system</span><span class="o">.</span><span class="n">linear_integrator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System force model: </span><span class="si">{</span><span class="n">sim_system</span><span class="o">.</span><span class="n">force_model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Domain box size: </span><span class="si">{</span><span class="n">sim_system</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">box_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.linear_integrator">
<span class="sig-name descname"><span class="pre">linear_integrator</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.LinearIntegrator" title="jaxdem.LinearIntegrator"><span class="pre">LinearIntegrator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.LinearMinimizer" title="jaxdem.LinearMinimizer"><span class="pre">LinearMinimizer</span></a></span><a class="headerlink" href="#jaxdem.System.linear_integrator" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.LinearIntegrator" title="jaxdem.LinearIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.LinearIntegrator</span></code></a> that advances the simulation linear state in time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.rotation_integrator">
<span class="sig-name descname"><span class="pre">rotation_integrator</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.RotationIntegrator" title="jaxdem.RotationIntegrator"><span class="pre">RotationIntegrator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.RotationMinimizer" title="jaxdem.RotationMinimizer"><span class="pre">RotationMinimizer</span></a></span><a class="headerlink" href="#jaxdem.System.rotation_integrator" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.RotationIntegrator" title="jaxdem.RotationIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.RotationIntegrator</span></code></a> that advances the simulation angular state in time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.collider">
<span class="sig-name descname"><span class="pre">collider</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.Collider" title="jaxdem.Collider"><span class="pre">Collider</span></a></span><a class="headerlink" href="#jaxdem.System.collider" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.Collider" title="jaxdem.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.Collider</span></code></a> that performs contact detection and computes inter-particle forces and potential energies.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.domain">
<span class="sig-name descname"><span class="pre">domain</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.Domain" title="jaxdem.Domain"><span class="pre">Domain</span></a></span><a class="headerlink" href="#jaxdem.System.domain" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.Domain" title="jaxdem.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.Domain</span></code></a> that defines the simulation boundaries, displacement rules, and boundary conditions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.force_manager">
<span class="sig-name descname"><span class="pre">force_manager</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.ForceManager" title="jaxdem.ForceManager"><span class="pre">ForceManager</span></a></span><a class="headerlink" href="#jaxdem.System.force_manager" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.ForceManager" title="jaxdem.ForceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.ForceManager</span></code></a> that handles per particle forces like external forces and resets forces.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.bonded_force_model">
<span class="sig-name descname"><span class="pre">bonded_force_model</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel"><span class="pre">BondedForceModel</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jaxdem.System.bonded_force_model" title="Link to this definition">#</a></dt>
<dd><p>Optional instance of <a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.ForceModel</span></code></a> that defines bonded interactions
by passing a force and energy function to the <cite>ForceManager</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.force_model">
<span class="sig-name descname"><span class="pre">force_model</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><span class="pre">ForceModel</span></a></span><a class="headerlink" href="#jaxdem.System.force_model" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.ForceModel</span></code></a> that defines the physical laws for inter-particle interactions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.mat_table">
<span class="sig-name descname"><span class="pre">mat_table</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><span class="pre">MaterialTable</span></a></span><a class="headerlink" href="#jaxdem.System.mat_table" title="Link to this definition">#</a></dt>
<dd><p>Instance of <a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.MaterialTable</span></code></a> holding material properties and pairwise interaction parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.dt">
<span class="sig-name descname"><span class="pre">dt</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.System.dt" title="Link to this definition">#</a></dt>
<dd><p>The global simulation time step <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.time">
<span class="sig-name descname"><span class="pre">time</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.System.time" title="Link to this definition">#</a></dt>
<dd><p>Elapsed simulation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.System.dim" title="Link to this definition">#</a></dt>
<dd><p>Spatial dimension of the system.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.step_count">
<span class="sig-name descname"><span class="pre">step_count</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.System.step_count" title="Link to this definition">#</a></dt>
<dd><p>Number of integration steps that have been performed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.key">
<span class="sig-name descname"><span class="pre">key</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.System.key" title="Link to this definition">#</a></dt>
<dd><p>PRNG key supporting stochastic functionality.  Always update using split to ensure new numbers are generated.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.System.interact_same_bond_id">
<span class="sig-name descname"><span class="pre">interact_same_bond_id</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.System.interact_same_bond_id" title="Link to this definition">#</a></dt>
<dd><p>Boolean scalar controlling interactions between particles with the same <code class="docutils literal notranslate"><span class="pre">bond_id</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), such pairs are masked out in colliders.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, these pairs are allowed to interact.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.System.create">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_integrator_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'verlet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_integrator_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'verletspiral'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collider_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'naive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'free'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonded_force_model_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonded_force_manager_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonded_force_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_model_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'spring'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_manager_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.materials.materialTable.html#jaxdem.materials.materialTable.MaterialTable" title="jaxdem.materials.materialTable.MaterialTable"><span class="pre">MaterialTable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_integrator_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_integrator_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collider_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_model_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interact_same_bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/system.py#L172-L357"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/system.html#System.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.System.create" title="Link to this definition">#</a></dt>
<dd><p>Factory method to create a <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> instance with specified components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_shape</strong> (<em>Tuple</em>) – Shape of the state tensors handled by the simulation. The penultimate
dimension corresponds to the number of particles <code class="docutils literal notranslate"><span class="pre">N</span></code> and the last
dimension corresponds to the spatial dimension <code class="docutils literal notranslate"><span class="pre">dim</span></code>.</p></li>
<li><p><strong>dt</strong> (<em>float</em><em>, </em><em>optional</em>) – The global simulation time step.</p></li>
<li><p><strong>linear_integrator_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The registered type string for the <a class="reference internal" href="jaxdem.integrators.html#jaxdem.integrators.LinearIntegrator" title="jaxdem.integrators.LinearIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.integrators.LinearIntegrator</span></code></a>
used to evolve translational degrees of freedom.</p></li>
<li><p><strong>rotation_integrator_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The registered type string for the <a class="reference internal" href="jaxdem.integrators.html#jaxdem.integrators.RotationIntegrator" title="jaxdem.integrators.RotationIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.integrators.RotationIntegrator</span></code></a>
used to evolve angular degrees of freedom.</p></li>
<li><p><strong>collider_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The registered type string for the <a class="reference internal" href="#jaxdem.Collider" title="jaxdem.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.Collider</span></code></a> to use.</p></li>
<li><p><strong>domain_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The registered type string for the <a class="reference internal" href="#jaxdem.Domain" title="jaxdem.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.Domain</span></code></a> to use.</p></li>
<li><p><strong>force_model_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The registered type string for the <a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.ForceModel</span></code></a> to use.</p></li>
<li><p><strong>force_manager_kw</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the constructor of <cite>ForceManager</cite>.</p></li>
<li><p><strong>mat_table</strong> (<a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><em>MaterialTable</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – An optional pre-configured <a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.MaterialTable</span></code></a>. If <cite>None</cite>, a
default <cite>jaxdem.MaterialTable</cite> will be created with one generic elastic material and “harmonic” <cite>jaxdem.MaterialMatchmaker</cite>.</p></li>
<li><p><strong>linear_integrator_kw</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Keyword arguments forwarded to the constructor of the selected
<cite>LinearIntegrator</cite> type.</p></li>
<li><p><strong>rotation_integrator_kw</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Keyword arguments forwarded to the constructor of the selected
<cite>RotationIntegrator</cite> type.</p></li>
<li><p><strong>collider_kw</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the constructor of the selected <cite>Collider</cite> type.</p></li>
<li><p><strong>domain_kw</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the constructor of the selected <cite>Domain</cite> type.</p></li>
<li><p><strong>force_model_kw</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the constructor of the selected <cite>ForceModel</cite> type.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Integer seed used for random number generation.  Defaults to 0.</p></li>
<li><p><strong>key</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Key used for the jax random number generation.  Defaults to None, shadowed by seed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A fully configured <cite>System</cite> instance ready for simulation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If a specified <cite>*_type</cite> is not registered in its respective factory,
    or if the <cite>mat_table</cite> is missing properties required by the <cite>force_model</cite>.</p></li>
<li><p><strong>TypeError</strong> – If constructor keyword arguments are invalid for any component.</p></li>
<li><p><strong>AssertionError</strong> – If the <cite>domain_kw</cite> ‘box_size’ or ‘anchor’ shapes do not match the <cite>dim</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Creating a 3D system with reflective boundaries and a custom <cite>dt</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system_reflect</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">state_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dt</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">domain_type</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">domain_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">box_size</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">]),</span> <span class="n">anchor</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">])),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">force_model_type</span><span class="o">=</span><span class="s2">&quot;spring&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System dt: </span><span class="si">{</span><span class="n">system_reflect</span><span class="o">.</span><span class="n">dt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Domain type: </span><span class="si">{</span><span class="n">system_reflect</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Creating a system with a pre-defined MaterialTable:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">custom_mat_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">young</span><span class="o">=</span><span class="mf">2.0e5</span><span class="p">,</span> <span class="n">poisson</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_material</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;custom_mat&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">custom_mat_kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_mat_table</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">MaterialTable</span><span class="o">.</span><span class="n">from_materials</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">custom_material</span><span class="p">],</span> <span class="n">matcher</span><span class="o">=</span><span class="n">jdem</span><span class="o">.</span><span class="n">MaterialMatchmaker</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system_custom_mat</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">state_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">mat_table</span><span class="o">=</span><span class="n">custom_mat_table</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">force_model_type</span><span class="o">=</span><span class="s2">&quot;spring&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.System.trajectory_rollout">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">trajectory_rollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state:</span> <span class="pre">State,</span> <span class="pre">system:</span> <span class="pre">System,</span> <span class="pre">*,</span> <span class="pre">n:</span> <span class="pre">Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">stride:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">strides:</span> <span class="pre">Optional[jax.Array]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">save_fn:</span> <span class="pre">Callable[[State,</span> <span class="pre">System],</span> <span class="pre">Any]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">_save_state_system&gt;,</span> <span class="pre">unroll:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/system.py#L359-L449"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/system.html#System.trajectory_rollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.System.trajectory_rollout" title="Link to this definition">#</a></dt>
<dd><p>Roll the system forward while collecting saved outputs at each frame.</p>
<p>The rollout always stores one output per frame via <cite>save_fn(state, system)</cite>.
The output of save_fn must be a pytree. Frame spacing can be either:
- constant (<cite>stride</cite>), or
- variable (<cite>strides</cite> jax.Array).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Initial state.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Initial system configuration.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of saved frames.
Required when <cite>strides</cite> is <cite>None</cite>.
Ignored when <cite>strides</cite> is provided.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em>) – Constant number of integration steps between consecutive saves.
Used only when <cite>strides</cite> is <cite>None</cite>. Defaults to 1.</p></li>
<li><p><strong>strides</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Integer 1D array of per-frame integration strides. When provided,
this overrides <cite>stride</cite>, and <cite>n</cite> is inferred from <cite>len(strides)</cite>.</p></li>
<li><p><strong>save_fn</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a><em>, </em><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a><em>]</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>optional</em>) – Function called after each saved frame. Its return pytree is stacked
along axis 0 across frames. Defaults to returning <cite>(state, system)</cite>.</p></li>
<li><p><strong>unroll</strong> (<em>int</em><em>, </em><em>optional</em>) – Unroll factor passed to the outer <cite>jax.lax.scan</cite>. Defaults to 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>(final_state, final_system, trajectory_like)</cite> where
<cite>trajectory_like</cite> is the stacked output of <cite>save_fn</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>n</cite> is missing while <cite>strides is None</cite>, or if <cite>strides</cite> is not 1D.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">grid_state</span><span class="p">(</span><span class="n">n_per_axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">state_shape</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Constant stride: n is required</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">final_state</span><span class="p">,</span> <span class="n">final_system</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">trajectory_rollout</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Variable strides: n inferred from len(strides)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deltas</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">final_state</span><span class="p">,</span> <span class="n">final_system</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">trajectory_rollout</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">deltas</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.System.step">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/system.py#L451-L487"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/system.html#System.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.System.step" title="Link to this definition">#</a></dt>
<dd><p>Advance the simulation by <cite>n</cite> integration steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Current system configuration.</p></li>
<li><p><strong>n</strong> (<em>int</em><em> or </em><em>jax.Array</em><em>, </em><em>optional</em>) – Number of integration steps. May be a Python <cite>int</cite> or a scalar
JAX array. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>(final_state, final_system)</cite> after <cite>n</cite> steps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Advance by 10 steps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_after_10_steps</span><span class="p">,</span> <span class="n">system_after_10_steps</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.System.stack">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">systems</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/system.py#L489-L515"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/system.html#System.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.System.stack" title="Link to this definition">#</a></dt>
<dd><p>Concatenates a sequence of <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> snapshots into a trajectory or batch along axis 0.</p>
<p>This method is useful for collecting simulation snapshots over time into a
single <cite>System</cite> object where the leading dimension represents time or when
preparing a batched system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>systems</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a><em>]</em>) – A sequence (e.g., list, tuple) of <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> instances to be stacked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> instance where each attribute is a JAX array with an
additional leading dimension representing the stacked trajectory.
For example, if input <cite>pos</cite> was <cite>(N, dim)</cite>, output <cite>pos</cite> will be <cite>(T, N, dim)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.System.unstack">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">unstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/system.py#L517-L540"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/system.html#System.unstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.System.unstack" title="Link to this definition">#</a></dt>
<dd><p>Split a stacked/batched <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> along the leading axis into a Python list.</p>
<p>This is the convenient inverse of <a class="reference internal" href="#jaxdem.System.stack" title="jaxdem.System.stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">System.stack()</span></code></a>:</p>
<ul class="simple">
<li><p>If <cite>stacked = System.stack([sys0, sys1, …])</cite>, then <cite>System.unstack(stacked)</cite> returns
<cite>[sys0, sys1, …]</cite>.</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The split is performed along axis 0 (the leading axis).</p></li>
<li><p>A single snapshot <cite>System</cite> cannot be unstacked with this method.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.VTKWriter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">VTKWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">writers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PosixPath('frames')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_queue_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_counter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_writer_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.writers.html#jaxdem.writers.VTKBaseWriter" title="jaxdem.writers.VTKBaseWriter"><span class="pre">VTKBaseWriter</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_manifest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/writers/vtkWriter.html#VTKWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.VTKWriter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>High-level front end for writing simulation data to VTK files.</p>
<p>This class orchestrates the conversion of JAX-based <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.State</span></code></a> and
<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.System</span></code></a> pytrees into VTK files, handling batches, trajectories,
and dispatch to registered <a class="reference internal" href="#jaxdem.VTKBaseWriter" title="jaxdem.VTKBaseWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.VTKBaseWriter</span></code></a> subclasses.</p>
<section id="how-leading-axes-are-interpreted">
<h2>How leading axes are interpreted<a class="headerlink" href="#how-leading-axes-are-interpreted" title="Link to this heading">#</a></h2>
<p>Let particle positions have shape <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the
number of particles and <code class="docutils literal notranslate"><span class="pre">dim</span></code> is 2 or 3. Define <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">=</span> <span class="pre">state.pos.ndim</span> <span class="pre">-</span> <span class="pre">2</span></code>,
i.e., the number of <em>leading</em> axes before <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">dim)</span></code>.</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">==</span> <span class="pre">0</span></code> — single snapshot</dt><dd><p>The input is one frame. It is written directly into
<code class="docutils literal notranslate"><span class="pre">frames/batch_00000000/</span></code> (no batching, no trajectory).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">trajectory=False</span></code> (default)</dt><dd><p>All leading axes are treated as <strong>batch</strong> axes (not time). If multiple
batch axes are present, they are <strong>flattened</strong> into a single batch axis:
<code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> with <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">prod(shape[:L])</span></code>. Each batch <code class="docutils literal notranslate"><span class="pre">b</span></code> is written
as a single snapshot under its own subdirectory
<code class="docutils literal notranslate"><span class="pre">frames/batch_XXXXXXXX/</span></code>. No trajectory is implied.</p>
<ul>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> → B separate directories with one frame each.</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">(B1,</span> <span class="pre">B2,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> → flatten to <code class="docutils literal notranslate"><span class="pre">(B1*B2,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> and treat as above.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">trajectory=True</span></code></dt><dd><p>The axis given by <code class="docutils literal notranslate"><span class="pre">trajectory_axis</span></code> is <strong>swapped to the front (axis 0)</strong>
and interpreted as <strong>time</strong> <code class="docutils literal notranslate"><span class="pre">T</span></code>. Any remaining leading axes are batch
axes. If more than one non-time leading axis exists, they are flattened
into a single batch axis so the data becomes <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> with
<code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">prod(other</span> <span class="pre">leading</span> <span class="pre">axes)</span></code>.</p>
<ul>
<li><dl class="simple">
<dt>If there is only time (<code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">==</span> <span class="pre">1</span></code>): <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> — a single batch</dt><dd><p>directory <code class="docutils literal notranslate"><span class="pre">frames/batch_00000000/</span></code> contains a time series with <code class="docutils literal notranslate"><span class="pre">T</span></code>
frames.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If there is time plus batching (<code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">&gt;=</span> <span class="pre">2</span></code>): <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> — each</dt><dd><p>batch <code class="docutils literal notranslate"><span class="pre">b</span></code> gets its own directory <code class="docutils literal notranslate"><span class="pre">frames/batch_XXXXXXXX/</span></code> containing
a time series (<code class="docutils literal notranslate"><span class="pre">T</span></code> frames) for that batch.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>After these swaps/reshapes, dispatch is:
- <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">dim)</span></code> → single snapshot
- <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> → batches (no time)
- <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> → single batch with a trajectory
- <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">B,</span> <span class="pre">N,</span> <span class="pre">dim)</span></code> → per-batch trajectories</p>
<p>Concrete writers receive per-frame NumPy arrays; leaves in <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>
are sliced/broadcast consistently with the current frame/batch.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.writers">
<span class="sig-name descname"><span class="pre">writers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.VTKWriter.writers" title="Link to this definition">#</a></dt>
<dd><p>A list of strings specifying which registered <a class="reference internal" href="#jaxdem.VTKBaseWriter" title="jaxdem.VTKBaseWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">VTKBaseWriter</span></code></a>
subclasses should be used for writing. If <cite>None</cite>, all available
<cite>VTKBaseWriter</cite> subclasses will be used.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></span><a class="headerlink" href="#jaxdem.VTKWriter.directory" title="Link to this definition">#</a></dt>
<dd><p>The base directory where output VTK files will be saved.
Subdirectories might be created within this path for batched outputs.
Defaults to “frames”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.binary">
<span class="sig-name descname"><span class="pre">binary</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="headerlink" href="#jaxdem.VTKWriter.binary" title="Link to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, VTK files will be written in binary format.
If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>, files will be written in ASCII format.
Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="headerlink" href="#jaxdem.VTKWriter.clean" title="Link to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, the <cite>directory</cite> will be completely emptied before any
files are written. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>. This is useful for
starting a fresh set of output frames.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.save_every">
<span class="sig-name descname"><span class="pre">save_every</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jaxdem.VTKWriter.save_every" title="Link to this definition">#</a></dt>
<dd><p>How often to write; writes on every <code class="docutils literal notranslate"><span class="pre">save_every</span></code>-th call to <a class="reference internal" href="#jaxdem.VTKWriter.save" title="jaxdem.VTKWriter.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.max_queue_size">
<span class="sig-name descname"><span class="pre">max_queue_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jaxdem.VTKWriter.max_queue_size" title="Link to this definition">#</a></dt>
<dd><p>The maximum number of scheduled writes allowed. <code class="docutils literal notranslate"><span class="pre">0</span></code> means unbounded.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.max_workers">
<span class="sig-name descname"><span class="pre">max_workers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jaxdem.VTKWriter.max_workers" title="Link to this definition">#</a></dt>
<dd><p>Maximum number of worker threads for the internal thread pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/vtkWriter.py#L234-L242"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/vtkWriter.html#VTKWriter.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.VTKWriter.close" title="Link to this definition">#</a></dt>
<dd><p>Flush all pending tasks and shut down the internal thread pool.
Safe to call multiple times.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.block_until_ready">
<span class="sig-name descname"><span class="pre">block_until_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/vtkWriter.py#L539-L551"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/vtkWriter.html#VTKWriter.block_until_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.VTKWriter.block_until_ready" title="Link to this definition">#</a></dt>
<dd><p>Wait until all scheduled writer tasks complete.</p>
<p>This will wait for all pending futures, propagate exceptions (if any),
and clear the pending set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.VTKWriter.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/vtkWriter.py#L553-L723"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/vtkWriter.html#VTKWriter.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.VTKWriter.save" title="Link to this definition">#</a></dt>
<dd><p>Schedule writing of a <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.State</span></code></a> / <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.System</span></code></a> pair to VTK files.</p>
<p>This public entry point interprets leading axes (batch vs. trajectory),
performs any required axis swapping and flattening, and then writes the
resulting frames using the registered writers. It also creates per-batch
ParaView <code class="docutils literal notranslate"><span class="pre">.pvd</span></code> collections referencing the generated files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The simulation <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.State</span></code></a> object to be saved. Its array leaves
must end with <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">dim)</span></code>.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.System</span></code></a> object corresponding to <cite>state</cite>. Leading axes
must be compatible (or broadcastable) with those of <cite>state</cite>.</p></li>
<li><p><strong>trajectory</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, interpret <code class="docutils literal notranslate"><span class="pre">trajectory_axis</span></code> as time and write a
trajectory; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, interpret the leading axis as batch.</p></li>
<li><p><strong>trajectory_axis</strong> (<em>int</em><em>, </em><em>optional</em>) – The axis in <cite>state</cite>/<cite>system</cite> to treat as the trajectory (time) axis
when <code class="docutils literal notranslate"><span class="pre">trajectory=True</span></code>. This axis is swapped to the front prior
to writing.</p></li>
<li><p><strong>batch0</strong> (<em>in</em>) – Initial value of batch from where to start counting the batches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.VTKBaseWriter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">VTKBaseWriter</span></span><a class="reference internal" href="../../_modules/jaxdem/writers.html#VTKBaseWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.VTKBaseWriter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for writers that output simulation data.</p>
<p>Concrete subclasses implement the <cite>write</cite> method to specify how a given
snapshot (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.State</span></code></a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.System</span></code></a> pair) is converted into a
specific file format.</p>
<p class="rubric">Example</p>
<p>To define a custom VTK writer, inherit from <cite>VTKBaseWriter</cite> and implement its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@VTKBaseWriter</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;my_custom_vtk_writer&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomVTKWriter</span><span class="p">(</span><span class="n">VTKBaseWriter</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.VTKBaseWriter.write">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/__init__.py#L44-L73"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers.html#VTKBaseWriter.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.VTKBaseWriter.write" title="Link to this definition">#</a></dt>
<dd><p>Write information from a simulation snapshot to a VTK PolyData file.</p>
<p>This abstract method is the core interface for all concrete VTK writers.
Implementations should assume that all jax arrays are converted to numpy arrays
before write is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The simulation <a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.State</span></code></a> snapshot to be written.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The simulation <a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.System</span></code></a> configuration.</p></li>
<li><p><strong>filename</strong> (<em>Path</em>) – Target path where the VTK file should be saved. The caller
guarantees that it exists.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If <cite>True</cite>, the VTK file is written in binary mode; if <cite>False</cite>,
it is written in ASCII (human-readable) mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">CheckpointWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PosixPath('checkpoints')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_to_keep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointWriter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Thin wrapper around Orbax checkpoint saving.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('checkpoints')</span></span><a class="headerlink" href="#jaxdem.CheckpointWriter.directory" title="Link to this definition">#</a></dt>
<dd><p>The base directory where checkpoints will be saved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.max_to_keep">
<span class="sig-name descname"><span class="pre">max_to_keep</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jaxdem.CheckpointWriter.max_to_keep" title="Link to this definition">#</a></dt>
<dd><p>Keep the last max_to_keep checkpoints. If None, everything is saved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.save_every">
<span class="sig-name descname"><span class="pre">save_every</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></span><a class="headerlink" href="#jaxdem.CheckpointWriter.save_every" title="Link to this definition">#</a></dt>
<dd><p>How often to write; writes on every <code class="docutils literal notranslate"><span class="pre">save_every</span></code>-th call to <a class="reference internal" href="#jaxdem.CheckpointWriter.save" title="jaxdem.CheckpointWriter.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.checkpointer">
<span class="sig-name descname"><span class="pre">checkpointer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CheckpointManager</span></span><a class="headerlink" href="#jaxdem.CheckpointWriter.checkpointer" title="Link to this definition">#</a></dt>
<dd><p>Orbax checkpoint manager for saving the checkpoints.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L118-L153"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointWriter.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointWriter.save" title="Link to this definition">#</a></dt>
<dd><p>Save a checkpoint for the provided state/system at a given step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The current system configuration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.block_until_ready">
<span class="sig-name descname"><span class="pre">block_until_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L155-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointWriter.block_until_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointWriter.block_until_ready" title="Link to this definition">#</a></dt>
<dd><p>Wait for the checkpointer to finish.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointWriter.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L162-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointWriter.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointWriter.close" title="Link to this definition">#</a></dt>
<dd><p>Wait for the checkpointer to finish and close it.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">CheckpointLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PosixPath('checkpoints')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointLoader" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Thin wrapper around Orbax checkpoint restoring for jaxdem.state and jaxdem.system.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('checkpoints')</span></span><a class="headerlink" href="#jaxdem.CheckpointLoader.directory" title="Link to this definition">#</a></dt>
<dd><p>The base directory where checkpoints will be saved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader.checkpointer">
<span class="sig-name descname"><span class="pre">checkpointer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CheckpointManager</span></span><a class="headerlink" href="#jaxdem.CheckpointLoader.checkpointer" title="Link to this definition">#</a></dt>
<dd><p>Orbax checkpoint manager for saving the checkpoints.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.state.html#jaxdem.state.State" title="jaxdem.state.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L215-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointLoader.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointLoader.load" title="Link to this definition">#</a></dt>
<dd><p>Restore a checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – <ul class="simple">
<li><p>If None, load the latest checkpoint.</p></li>
<li><p>Otherwise, load the specified step.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the restored <cite>State</cite> and <cite>System</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader.latest_step">
<span class="sig-name descname"><span class="pre">latest_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L290-L292"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointLoader.latest_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointLoader.latest_step" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader.block_until_ready">
<span class="sig-name descname"><span class="pre">block_until_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L294-L296"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointLoader.block_until_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointLoader.block_until_ready" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointLoader.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L298-L303"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointLoader.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointLoader.close" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">CheckpointModelWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PosixPath('checkpoints')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_to_keep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelWriter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Thin wrapper around Orbax checkpoint saving for jaxdem.rl.models.Model.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('checkpoints')</span></span><a class="headerlink" href="#jaxdem.CheckpointModelWriter.directory" title="Link to this definition">#</a></dt>
<dd><p>The base directory where checkpoints will be saved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.max_to_keep">
<span class="sig-name descname"><span class="pre">max_to_keep</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jaxdem.CheckpointModelWriter.max_to_keep" title="Link to this definition">#</a></dt>
<dd><p>Keep the last max_to_keep checkpoints. If None, everything is saved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.save_every">
<span class="sig-name descname"><span class="pre">save_every</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></span><a class="headerlink" href="#jaxdem.CheckpointModelWriter.save_every" title="Link to this definition">#</a></dt>
<dd><p>How often to write; writes on every <code class="docutils literal notranslate"><span class="pre">save_every</span></code>-th call to <a class="reference internal" href="#jaxdem.CheckpointModelWriter.save" title="jaxdem.CheckpointModelWriter.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.checkpointer">
<span class="sig-name descname"><span class="pre">checkpointer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CheckpointManager</span></span><a class="headerlink" href="#jaxdem.CheckpointModelWriter.checkpointer" title="Link to this definition">#</a></dt>
<dd><p>Orbax checkpoint manager for saving the checkpoints.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></span><a class="headerlink" href="#jaxdem.CheckpointModelWriter.clean" title="Link to this definition">#</a></dt>
<dd><p>Whether to clean the directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.rl.html#jaxdem.rl.Model" title="jaxdem.rl.Model"><span class="pre">Model</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L377-L395"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelWriter.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelWriter.save" title="Link to this definition">#</a></dt>
<dd><p>Save model at a step: stores model_state and JSON metadata.
Assumes model.metadata includes JSON-serializable fields. We add model_type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.block_until_ready">
<span class="sig-name descname"><span class="pre">block_until_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L397-L399"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelWriter.block_until_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelWriter.block_until_ready" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelWriter.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L401-L406"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelWriter.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelWriter.close" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">CheckpointModelLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PosixPath('checkpoints')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelLoader" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Thin wrapper around Orbax checkpoint restoring for jaxdem.rl.models.Model.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('checkpoints')</span></span><a class="headerlink" href="#jaxdem.CheckpointModelLoader.directory" title="Link to this definition">#</a></dt>
<dd><p>The base directory where checkpoints will be saved.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader.checkpointer">
<span class="sig-name descname"><span class="pre">checkpointer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CheckpointManager</span></span><a class="headerlink" href="#jaxdem.CheckpointModelLoader.checkpointer" title="Link to this definition">#</a></dt>
<dd><p>Orbax checkpoint manager for saving the checkpoints.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.rl.html#jaxdem.rl.Model" title="jaxdem.rl.Model"><span class="pre">Model</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L451-L521"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelLoader.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelLoader.load" title="Link to this definition">#</a></dt>
<dd><p>Load a model from a given step (or the latest if None).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader.latest_step">
<span class="sig-name descname"><span class="pre">latest_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L523-L525"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelLoader.latest_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelLoader.latest_step" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader.block_until_ready">
<span class="sig-name descname"><span class="pre">block_until_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L527-L529"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelLoader.block_until_ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelLoader.block_until_ready" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.CheckpointModelLoader.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/writers/checkpoints.py#L531-L536"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/writers/checkpoints.html#CheckpointModelLoader.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.CheckpointModelLoader.close" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.Material">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">Material</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/materials.html#Material"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Material" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a></p>
<p>Abstract base class for defining materials.</p>
<p>Concrete subclasses of <cite>Material</cite> should define scalar or vector fields (e.g., <cite>young</cite>, <cite>poisson</cite>, <cite>mu</cite>)
that represent specific physical properties of a material. These fields are
then collected and managed by the <a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaterialTable</span></code></a>.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Each field defined in a concrete <cite>Material</cite> subclass will become a named property in the <a class="reference internal" href="#jaxdem.MaterialTable.props" title="jaxdem.MaterialTable.props"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MaterialTable.props</span></code></a> dictionary.</p></li>
</ul>
<p class="rubric">Example</p>
<p>To define a custom material, inherit from <cite>Material</cite></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@Material</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;my_custom_material&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomMaterial</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.Material.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#jaxdem.Material.density" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.MaterialTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">MaterialTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">props</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matcher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.material_matchmakers.html#jaxdem.material_matchmakers.MaterialMatchmaker" title="jaxdem.material_matchmakers.MaterialMatchmaker"><span class="pre">MaterialMatchmaker</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/materials/materialTable.html#MaterialTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.MaterialTable" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A container for material properties, organized as Structures of Arrays (SoA)
and pre-computed effective pair properties.</p>
<p>This class centralizes material data, allowing efficient access to scalar
properties for individual materials and pre-calculated effective properties
for material-pair interactions.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Scalar properties can be accessed directly using dot notation (e.g., <cite>material_table.young</cite>).</p></li>
<li><p>Effective pair properties can also be accessed directly using dot notation
(e.g., <cite>material_table.young_eff</cite>).</p></li>
</ul>
<p class="rubric">Example</p>
<p>Creating a <cite>MaterialTable</cite> from multiple material types:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jaxdem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jdem</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define different material instances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat1</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;elastic&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">2500.0</span><span class="p">,</span> <span class="n">young</span><span class="o">=</span><span class="mf">1.0e4</span><span class="p">,</span> <span class="n">poisson</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat2</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;elasticfrict&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">7800.0</span><span class="p">,</span> <span class="n">young</span><span class="o">=</span><span class="mf">2.0e4</span><span class="p">,</span> <span class="n">poisson</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a MaterialTable using a linear matcher</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matcher_instance</span> <span class="o">=</span> <span class="n">jdem</span><span class="o">.</span><span class="n">MaterialMatchmaker</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat_table</span> <span class="o">=</span> <span class="n">matcher_instance</span><span class="o">.</span><span class="n">from_materials</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">mat1</span><span class="p">,</span> <span class="n">mat2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">matcher</span><span class="o">=</span><span class="n">matcher_instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.MaterialTable.props">
<span class="sig-name descname"><span class="pre">props</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.MaterialTable.props" title="Link to this definition">#</a></dt>
<dd><p>A dictionary mapping scalar material property names (e.g., “young”, “poisson”, “mu”)
to JAX arrays. Each array has shape <cite>(M,)</cite>, where <cite>M</cite> is the total number
of distinct material types present in the table.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.MaterialTable.pair">
<span class="sig-name descname"><span class="pre">pair</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.MaterialTable.pair" title="Link to this definition">#</a></dt>
<dd><p>A dictionary mapping effective pair property names (e.g., “young_eff”, “mu_eff”)
to JAX arrays. Each array has shape <cite>(M, M)</cite>, representing the effective
property for interactions between any two material types (M_i, M_j).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.MaterialTable.matcher">
<span class="sig-name descname"><span class="pre">matcher</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.material_matchmakers.html#jaxdem.material_matchmakers.MaterialMatchmaker" title="jaxdem.material_matchmakers.MaterialMatchmaker"><span class="pre">MaterialMatchmaker</span></a></span><a class="headerlink" href="#jaxdem.MaterialTable.matcher" title="Link to this definition">#</a></dt>
<dd><p>The <a class="reference internal" href="#jaxdem.MaterialMatchmaker" title="jaxdem.MaterialMatchmaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.MaterialMatchmaker</span></code></a> instance that was used to compute the
effective pair properties stored in the <a class="reference internal" href="#jaxdem.MaterialTable.pair" title="jaxdem.MaterialTable.pair"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pair</span></code></a> dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.MaterialTable.from_materials">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_materials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.Material" title="jaxdem.Material"><span class="pre">Material</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">matcher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.MaterialMatchmaker" title="jaxdem.MaterialMatchmaker"><span class="pre">MaterialMatchmaker</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><span class="pre">MaterialTable</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/materials/materialTable.py#L78-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/materials/materialTable.html#MaterialTable.from_materials"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.MaterialTable.from_materials" title="Link to this definition">#</a></dt>
<dd><p>Constructs a <a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaterialTable</span></code></a> from a sequence of <a class="reference internal" href="#jaxdem.Material" title="jaxdem.Material"><code class="xref py py-class docutils literal notranslate"><span class="pre">Material</span></code></a> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mats</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#jaxdem.Material" title="jaxdem.Material"><em>Material</em></a><em>]</em>) – A sequence of concrete <a class="reference internal" href="#jaxdem.Material" title="jaxdem.Material"><code class="xref py py-class docutils literal notranslate"><span class="pre">Material</span></code></a> instances. Each instance
represents a distinct material type in the simulation. The order in
this sequence defines their material IDs (0 to <cite>len(mats)-1</cite>).</p></li>
<li><p><strong>matcher</strong> (<a class="reference internal" href="#jaxdem.MaterialMatchmaker" title="jaxdem.MaterialMatchmaker"><em>MaterialMatchmaker</em></a>) – The <a class="reference internal" href="#jaxdem.MaterialMatchmaker" title="jaxdem.MaterialMatchmaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.MaterialMatchmaker</span></code></a> instance to be used for computing
effective pair properties (e.g., harmonic mean, arithmetic mean).</p></li>
<li><p><strong>fill</strong> (<em>float</em><em>, </em><em>optional</em>) – A fill value used for material properties that are not defined in a
specific <cite>Material</cite> subclass (e.g., if an <code class="xref py py-class docutils literal notranslate"><span class="pre">Elastic</span></code> material
is provided when an <code class="xref py py-class docutils literal notranslate"><span class="pre">ElasticFriction</span></code> is expected, <cite>mu</cite>
would be filled with this value). Defaults to 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <cite>MaterialTable</cite> instance containing the scalar properties and
pre-computed effective pair properties for all provided materials.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable">MaterialTable</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If <cite>mats</cite> is not a sequence of <cite>Material</cite> instances.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.MaterialMatchmaker">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">MaterialMatchmaker</span></span><a class="reference internal" href="../../_modules/jaxdem/material_matchmakers.html#MaterialMatchmaker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.MaterialMatchmaker" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for defining how to combine (mix) material properties.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>These matchmakers are used by the <a class="reference internal" href="#jaxdem.MaterialTable" title="jaxdem.MaterialTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxdem.MaterialTable</span></code></a> to pre-compute interaction matrices.</p></li>
</ul>
<p class="rubric">Example</p>
<p>To define a custom matchmaker, inherit from <a class="reference internal" href="#jaxdem.MaterialMatchmaker" title="jaxdem.MaterialMatchmaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaterialMatchmaker</span></code></a> and implement
its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@MaterialMatchmaker</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;myCustomForce&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomMatchmaker</span><span class="p">(</span><span class="n">MaterialMatchmaker</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.MaterialMatchmaker.get_effective_property">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">get_effective_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/material_matchmakers/__init__.py#L38-L60"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/material_matchmakers.html#MaterialMatchmaker.get_effective_property"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.MaterialMatchmaker.get_effective_property" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to compute the effective property value from two individual material properties.</p>
<p>Concrete implementations define the specific mixing rule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prop1</strong> (<em>jax.Array</em>) – The property value from the first material. Can be a scalar or an array.</p></li>
<li><p><strong>prop2</strong> (<em>jax.Array</em>) – The property value from the second material. Can be a scalar or an array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A JAX array representing the effective property, computed from <cite>prop1</cite> and <cite>prop2</cite>
according to the matchmaker’s specific rule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.ForceModel">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">ForceModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">laws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/forces.html#ForceModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for defining inter-particle force laws and their corresponding potential energies.</p>
<p>Concrete subclasses implement specific force and energy models, such as
linear springs, Hertzian contacts, etc.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="#jaxdem.ForceModel.force" title="jaxdem.ForceModel.force"><code class="xref py py-meth docutils literal notranslate"><span class="pre">force()</span></code></a> and <a class="reference internal" href="#jaxdem.ForceModel.energy" title="jaxdem.ForceModel.energy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">energy()</span></code></a> methods should correctly handle the
case where <cite>i</cite> and <cite>j</cite> refer to the same particle (i.e., <cite>i == j</cite>).
There is no guarantee that self-interaction calls will not occur.</p></li>
</ul>
<p class="rubric">Example</p>
<p>To define a custom force model, inherit from <a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForceModel</span></code></a> and implement
its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ForceModel</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;myCustomForce&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomForce</span><span class="p">(</span><span class="n">ForceModel</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceModel.laws">
<span class="sig-name descname"><span class="pre">laws</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.ForceModel.laws" title="Link to this definition">#</a></dt>
<dd><p>A static tuple of other <a class="reference internal" href="#jaxdem.ForceModel" title="jaxdem.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForceModel</span></code></a> instances that compose this force model.</p>
<p>This allows for creating composite force models (e.g., a total force being
the sum of a spring force and a damping force).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceModel.force">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/__init__.py#L55-L80"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces.html#ForceModel.force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceModel.force" title="Link to this definition">#</a></dt>
<dd><p>Compute the force and torque vector acting on particle <span class="math notranslate nohighlight">\(i\)</span> due to particle <span class="math notranslate nohighlight">\(j\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Index of the first particle (on which the interaction acts).</p></li>
<li><p><strong>j</strong> (<em>int</em>) – Index of the second particle (which is exerting the interaction).</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(force,</span> <span class="pre">torque)</span></code> where <code class="docutils literal notranslate"><span class="pre">force</span></code> has shape <code class="docutils literal notranslate"><span class="pre">(dim,)</span></code> and <code class="docutils literal notranslate"><span class="pre">torque</span></code> has shape <code class="docutils literal notranslate"><span class="pre">(1,)</span></code> in 2D or <code class="docutils literal notranslate"><span class="pre">(3,)</span></code> in 3D.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceModel.energy">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/__init__.py#L82-L108"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces.html#ForceModel.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceModel.energy" title="Link to this definition">#</a></dt>
<dd><p>Compute the potential energy of the interaction between particle <span class="math notranslate nohighlight">\(i\)</span> and particle <span class="math notranslate nohighlight">\(j\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Index of the first particle.</p></li>
<li><p><strong>j</strong> (<em>int</em>) – Index of the second particle.</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar JAX array representing the potential energy of the interaction
between particles <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.ForceModel.required_material_properties">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">required_material_properties</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/__init__.py#L110-L119"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceModel.required_material_properties" title="Link to this definition">#</a></dt>
<dd><p>A static tuple of strings specifying the material properties required by this force model.</p>
<p>These properties (e.g., ‘young_eff’, ‘restitution’, …) must be present in the
<a class="reference internal" href="#jaxdem.System.mat_table" title="jaxdem.System.mat_table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">System.mat_table</span></code></a> for the model to function correctly. This is used
for validation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.BondedForceModel">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">BondedForceModel</span></span><a class="reference internal" href="../../_modules/jaxdem/bonded_forces.html#BondedForceModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.BondedForceModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract interface for bonded interaction containers.</p>
<p>This class is intended as the general bonded-force abstraction in JaxDEM.</p>
<section id="design-intent">
<h2>Design intent<a class="headerlink" href="#design-intent" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A concrete bonded container instance is stored on
<a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>.</p></li>
<li><p>The container exposes bonded force/energy callables through
<code class="xref py py-meth docutils literal notranslate"><span class="pre">create_force_and_energy_fns()</span></code>.</p></li>
<li><p>The <a class="reference internal" href="jaxdem.forces.force_manager.html#jaxdem.forces.force_manager.ForceManager" title="jaxdem.forces.force_manager.ForceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForceManager</span></code></a> obtains and
executes these callables to compute bonded contributions at each time step.</p></li>
<li><p>Bonded data remains accessible through <a class="reference internal" href="jaxdem.system.html#jaxdem.system.System" title="jaxdem.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>
(via the container itself), so the force/energy callables can read what they
need.</p></li>
</ul>
<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.BondedForceModel.force_and_energy_fns">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">force_and_energy_fns</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">EnergyFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/bonded_forces/__init__.py#L44-L60"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.BondedForceModel.force_and_energy_fns" title="Link to this definition">#</a></dt>
<dd><p>Build bonded force/energy callables consumed by the force manager.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(force_fn,</span> <span class="pre">energy_fn,</span> <span class="pre">is_com_force)</span></code> where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">force_fn</span></code> computes bonded force and torque contributions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">energy_fn</span></code> computes bonded potential-energy contributions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_com_force</span></code> indicates where force is applied:
<code class="docutils literal notranslate"><span class="pre">True</span></code> for center-of-mass application, <code class="docutils literal notranslate"><span class="pre">False</span></code> for
contact-point application. This has no effect on spheres.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[ForceFunction, EnergyFunction, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.BondedForceModel.merge">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/bonded_forces/__init__.py#L62-L89"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/bonded_forces.html#BondedForceModel.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.BondedForceModel.merge" title="Link to this definition">#</a></dt>
<dd><p>Merge two or more bonded-force models into one.</p>
<p>Concatenates topology, reference, and coefficient arrays. Vertex
indices and body IDs are shifted automatically so that references
remain consistent. When one side carries a term that the other does
not, missing coefficients are padded with <code class="docutils literal notranslate"><span class="pre">0</span></code> and missing reference
values with <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model1</strong> (<a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel"><em>BondedForceModel</em></a>) – Base model.</p></li>
<li><p><strong>model2</strong> (<a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel"><em>BondedForceModel</em></a><em> or </em><em>Sequence</em><em>[</em><a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel"><em>BondedForceModel</em></a><em>]</em>) – Model(s) to merge into <em>model1</em>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new model containing all bodies from both sides.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel">BondedForceModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.BondedForceModel.add">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.bonded_forces.html#jaxdem.bonded_forces.BondedForceModel" title="jaxdem.bonded_forces.BondedForceModel"><span class="pre">BondedForceModel</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/bonded_forces/__init__.py#L91-L113"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/bonded_forces.html#BondedForceModel.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.BondedForceModel.add" title="Link to this definition">#</a></dt>
<dd><p>Create a new body from raw arrays and merge it into an existing model.</p>
<p>This is a convenience wrapper equivalent to calling the concrete
<code class="docutils literal notranslate"><span class="pre">Create</span></code> constructor followed by <a class="reference internal" href="#jaxdem.BondedForceModel.merge" title="jaxdem.BondedForceModel.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">merge()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel"><em>BondedForceModel</em></a>) – Existing model to extend.</p></li>
<li><p><strong>**kwargs</strong> – Constructor arguments forwarded to the concrete <code class="docutils literal notranslate"><span class="pre">Create</span></code> method
(e.g. <code class="docutils literal notranslate"><span class="pre">vertices</span></code>, <code class="docutils literal notranslate"><span class="pre">elements</span></code>, coefficients, …).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extended model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.BondedForceModel" title="jaxdem.BondedForceModel">BondedForceModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.BondedForceModel.stack">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">BondedT</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">BondedT</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/bonded_forces/__init__.py#L115-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/bonded_forces.html#BondedForceModel.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.BondedForceModel.stack" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.BondedForceModel.unstack">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">unstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BondedT</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">BondedT</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/bonded_forces/__init__.py#L131-L148"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/bonded_forces.html#BondedForceModel.unstack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.BondedForceModel.unstack" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.Integrator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">Integrator</span></span><a class="reference internal" href="../../_modules/jaxdem/integrators.html#Integrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Integrator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for defining the interface for time-stepping.</p>
<p class="rubric">Example</p>
<p>To define a custom integrator, inherit from <a class="reference internal" href="#jaxdem.Integrator" title="jaxdem.Integrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integrator</span></code></a> and implement its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@Integrator</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;myCustomIntegrator&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomIntegrator</span><span class="p">(</span><span class="n">Integrator</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Integrator.step_before_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">step_before_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/integrators/__init__.py#L38-L61"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/integrators.html#Integrator.step_before_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Integrator.step_before_force" title="Link to this definition">#</a></dt>
<dd><p>Advance the simulation state before the force evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated State and System after one time step of integration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates state and system</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Integrator.step_after_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">step_after_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/integrators/__init__.py#L63-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/integrators.html#Integrator.step_after_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Integrator.step_after_force" title="Link to this definition">#</a></dt>
<dd><p>Advance the simulation state after the force computation by one time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated State and System after one time step of integration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates state and system</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Integrator.initialize">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/integrators/__init__.py#L88-L117"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/integrators.html#Integrator.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Integrator.initialize" title="Link to this definition">#</a></dt>
<dd><p>Some integration methods require an initialization step, for example LeapFrog.
This function implements the interface for the initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated State and System after the initialization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates state and system</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.LinearIntegrator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">LinearIntegrator</span></span><a class="reference internal" href="../../_modules/jaxdem/integrators.html#LinearIntegrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.LinearIntegrator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.Integrator" title="jaxdem.integrators.Integrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integrator</span></code></a></p>
<p>Namespace for translation/linear-time integrators.</p>
<section id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Link to this heading">#</a></h2>
<p>Groups integrators that update linear state (e.g., position and velocity).
Concrete methods (e.g., DirectEuler) should subclass this to register via
the Factory and to signal they operate on linear kinematics.</p>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.RotationIntegrator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">RotationIntegrator</span></span><a class="reference internal" href="../../_modules/jaxdem/integrators.html#RotationIntegrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.RotationIntegrator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.Integrator" title="jaxdem.integrators.Integrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integrator</span></code></a></p>
<p>Namespace for rotation/angular-time integrators.</p>
<section id="id1">
<h2>Purpose<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Groups integrators that update angular state (e.g., orientation, angular
velocity). Concrete methods (e.g., DirectEulerRotation) should subclass
this to register via the Factory and to signal they operate on rotational
kinematics.</p>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.Minimizer">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">Minimizer</span></span><a class="reference internal" href="../../_modules/jaxdem/minimizers.html#Minimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Minimizer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.Integrator" title="jaxdem.integrators.Integrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integrator</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for energy minimizers.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><cite>Minimizer</cite> subclasses the generic <cite>Integrator</cite> interface, so it can be
plugged in anywhere an <cite>Integrator</cite> is expected (e.g., as <cite>System.linear_integrator</cite>).</p></li>
<li><p>The default implementations of <cite>step_before_force</cite>, <cite>step_after_force</cite>,
and <cite>initialize</cite> are inherited from <cite>Integrator</cite> and act as no-ops.</p></li>
<li><p>Concrete minimizers should typically override <cite>step_after_force</cite> to
update the state based on the current forces in an energy-decreasing way.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.LinearMinimizer">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">LinearMinimizer</span></span><a class="reference internal" href="../../_modules/jaxdem/minimizers.html#LinearMinimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.LinearMinimizer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.minimizers.html#jaxdem.minimizers.Minimizer" title="jaxdem.minimizers.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a></p>
<p>Namespace for translation/linear-state minimizers.</p>
<p>Concrete minimizers (e.g., GradientDescent) should subclass this to
signal that they operate on linear kinematics.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.RotationMinimizer">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">RotationMinimizer</span></span><a class="reference internal" href="../../_modules/jaxdem/minimizers.html#RotationMinimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.RotationMinimizer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.minimizers.html#jaxdem.minimizers.Minimizer" title="jaxdem.minimizers.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a></p>
<p>Namespace for rotational-state minimizers.</p>
<p>Concrete minimizers that relax orientations / angular DOFs should
subclass this.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.Collider">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">Collider</span></span><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Collider" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>The base interface for defining how contact detection and force computations are performed in a simulation.</p>
<p>Concrete subclasses of <cite>Collider</cite> implement the specific algorithms for calculating the interactions.</p>
<p class="rubric">Notes</p>
<p>Self-interaction (i.e., calling the force/energy computation for <cite>i=j</cite>) is allowed,
and the underlying <cite>force_model</cite> is responsible for correctly handling or
ignoring this case.</p>
<p class="rubric">Example</p>
<p>To define a custom collider, inherit from <cite>Collider</cite>, register it and implement its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@Collider</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;CustomCollider&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">CustomCollider</span><span class="p">(</span><span class="n">Collider</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<p>Then, instantiate it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jaxdem</span><span class="o">.</span><span class="n">Collider</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;CustomCollider&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">custom_collider_kw</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Collider.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L50-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Collider.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to compute the total force acting on each particle in the simulation.</p>
<p>Implementations should calculate inter-particle forces and torques based on the current
<cite>state</cite> and <cite>system</cite> configuration, then update the <cite>force</cite> and <cite>torque</cite> attributes of the
<cite>state</cite> object with the resulting total force and torque for each particle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <cite>State</cite> object (with computed forces) and the <cite>System</cite> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates state and system</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Collider.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L80-L108"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Collider.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to compute the total potential energy of the system.</p>
<p>Implementations should calculate the sum per particle of all potential energies
present in the system based on the current <cite>state</cite> and <cite>system</cite> configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A scalar JAX array representing the total potential energy of each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential_energy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">collider</span><span class="o">.</span><span class="n">compute_potential_energy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Potential energy per particle: </span><span class="si">{</span><span class="n">potential_energy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">potential_energy</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (N,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Collider.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L110-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Collider.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Build a neighbor list for the current collider.</p>
<p>This is primarily used by neighbor-list-based algorithms and diagnostics.
Implementations should match the cell-list semantics:</p>
<ul class="simple">
<li><p>Returns a neighbor list of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">max_neighbors)</span></code> padded with <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p>Neighbor indices must refer to the returned (possibly sorted) <code class="docutils literal notranslate"><span class="pre">state</span></code>.</p></li>
<li><p>Also returns an <code class="docutils literal notranslate"><span class="pre">overflow</span></code> boolean flag (True if any particle exceeded
<code class="docutils literal notranslate"><span class="pre">max_neighbors</span></code> neighbors within the cutoff).</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.Domain">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">Domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/domains.html#Domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Domain" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>The base interface for defining the simulation domain and the effect of its boundary conditions.</p>
<dl class="simple">
<dt>The <cite>Domain</cite> class defines how:</dt><dd><ul class="simple">
<li><p>Relative displacement vectors between particles are calculated.</p></li>
<li><p>Particles’ positions are “shifted” or constrained to remain within the
defined simulation boundaries based on the boundary condition type.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To define a custom domain, inherit from <cite>Domain</cite> and implement its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@Domain</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;my_custom_domain&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomDomain</span><span class="p">(</span><span class="n">Domain</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.Domain.box_size">
<span class="sig-name descname"><span class="pre">box_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.Domain.box_size" title="Link to this definition">#</a></dt>
<dd><p>Length of the simulation domain along each dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.Domain.anchor">
<span class="sig-name descname"><span class="pre">anchor</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.Domain.anchor" title="Link to this definition">#</a></dt>
<dd><p>Anchor position (minimum coordinate) of the simulation domain.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.Domain.periodic">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">periodic</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/domains/__init__.py#L55-L58"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Domain.periodic" title="Link to this definition">#</a></dt>
<dd><p>Whether the domain enforces periodic boundary conditions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Domain.Create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/domains/__init__.py#L60-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/domains.html#Domain.Create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Domain.Create" title="Link to this definition">#</a></dt>
<dd><p>Default factory method for the Domain class.</p>
<p>This method constructs a new Domain instance with a box-shaped domain
of the given dimensionality. If <cite>box_size</cite> or <cite>anchor</cite> are not provided,
they are initialized to default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – The dimensionality of the domain (e.g., 2, 3).</p></li>
<li><p><strong>box_size</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – The size of the domain along each dimension. If not provided,
defaults to an array of ones with shape <cite>(dim,)</cite>.</p></li>
<li><p><strong>anchor</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – The anchor (origin) of the domain. If not provided,
defaults to an array of zeros with shape <cite>(dim,)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new instance of the Domain subclass with the specified
or default configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.Domain" title="jaxdem.Domain">Domain</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If <cite>box_size</cite> and <cite>anchor</cite> do not have the same shape.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Domain.displacement">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">displacement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/domains/__init__.py#L107-L133"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/domains.html#Domain.displacement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Domain.displacement" title="Link to this definition">#</a></dt>
<dd><p>Computes the displacement vector between two particles <span class="math notranslate nohighlight">\(r_i\)</span> and <span class="math notranslate nohighlight">\(r_j\)</span>,
considering the domain’s boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ri</strong> (<em>jax.Array</em>) – Position vector of the first particle <span class="math notranslate nohighlight">\(r_i\)</span>. Shape <cite>(dim,)</cite>.</p></li>
<li><p><strong>rj</strong> (<em>jax.Array</em>) – Position vector of the second particle <span class="math notranslate nohighlight">\(r_j\)</span>. Shape <cite>(dim,)</cite>.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation, containing the <cite>domain</cite> instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The displacement vector <span class="math notranslate nohighlight">\(r_{ij} = r_i - r_j\)</span>,
adjusted for boundary conditions. Shape <cite>(dim,)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rij</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">displacement</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">rj</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Domain.apply">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/domains/__init__.py#L135-L168"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/domains.html#Domain.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Domain.apply" title="Link to this definition">#</a></dt>
<dd><p>Applies boundary conditions during the simulation step.</p>
<p>This method updates the <cite>state</cite> based on the domain’s rules, ensuring
particles handle interactions at boundaries appropriately (e.g., reflection).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <cite>State</cite> object adjusted by the boundary conditions and the <cite>System</cite> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Periodic boundary conditions do not require wrapping coordinates during time stepping,
but reflective boundaries require changing positions and velocities. To wrap positions
for periodic boundaries so they are displayed correctly when saving, and other algorithms
use the shift method.</p></li>
<li><p>This method donates state and system</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Domain.shift">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/domains/__init__.py#L170-L194"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/domains.html#Domain.shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Domain.shift" title="Link to this definition">#</a></dt>
<dd><p>This method updates the <cite>state</cite> based on the domain’s rules, ensuring
particles remain within the simulation box or handle interactions
at boundaries appropriately (e.g., reflection, wrapping).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <cite>State</cite> object adjusted by the boundary conditions and the <cite>System</cite> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">,</span> <span class="n">system</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.Factory">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">Factory</span></span><a class="reference internal" href="../../_modules/jaxdem/factory.html#Factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Factory" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base factory class for pluggable components. This abstract base class provides a mechanism for registering and creating
subclasses based on a string key.</p>
<p class="rubric">Notes</p>
<p>Each concrete subclass gets its own private registry. Keys are strings and not case sensitive.</p>
<p class="rubric">Example</p>
<p>Use Factory as a base class for a specific component type (e.g., <cite>Foo</cite>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">Foo</span><span class="p">(</span><span class="n">Factory</span><span class="p">[</span><span class="s2">&quot;Foo&quot;</span><span class="p">],</span> <span class="n">ABC</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="o">...</span>
</pre></div>
</div>
<p>Register a concrete subclass of <cite>Foo</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@Foo</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">bar</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
<p>To instantiate the subclass instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Foo</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">bar_kw</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Factory.registry_name">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">registry_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/factory.py#L82-L90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/factory.html#Factory.registry_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Factory.registry_name" title="Link to this definition">#</a></dt>
<dd><p>Returns the key under which this class is registered.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jaxdem.Factory.type_name">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">type_name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/factory.py#L92-L97"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Factory.type_name" title="Link to this definition">#</a></dt>
<dd><p>Returns the key under which this instance’s class is registered.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Factory.register">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">SubT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">SubT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/factory.py#L99-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/factory.html#Factory.register"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Factory.register" title="Link to this definition">#</a></dt>
<dd><p>Registers a subclass with the factory’s registry.</p>
<p>This method returns a decorator that can be applied to a class
to register it under a specific <cite>key</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The string key under which to register the subclass. If <cite>None</cite>,
the lowercase name of the subclass itself will be used as the key.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A decorator function that takes a class and registers it, returning
the class unchanged.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[Type[T]], Type[T]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the provided <cite>key</cite> (or the default class name) is already
    registered in the factory’s registry.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Register a class named “MyComponent” under the key “mycomp”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@MyFactory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;mycomp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyComponent</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
<p>Register a class named “DefaultComponent” using its own name as the key:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@MyFactory</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultComponent</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.Factory.create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">RootT</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/factory.py#L172-L236"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/factory.html#Factory.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.Factory.create" title="Link to this definition">#</a></dt>
<dd><p>Creates and returns an instance of a registered subclass.</p>
<p>This method looks up the subclass associated with the given <cite>key</cite>
in the factory’s registry and then calls its constructor with the
provided arguments. If the subclass defines a <cite>Create</cite> method (capitalized),
that method will be called instead of the constructor. This allows
subclasses to validate or preprocess arguments before instantiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The registration key of the subclass to be created.</p></li>
<li><p><strong>**kw</strong> (<em>Any</em>) – Arbitrary keyword arguments to be passed directly to the constructor of the registered subclass.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the registered subclass.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>T</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If the provided <cite>key</cite> is not found in the factory’s registry.</p></li>
<li><p><strong>TypeError</strong> – If the provided <cite>**kw</cite> arguments do not match the signature
    of the registered subclass’s constructor.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Given <cite>Foo</cite> factory and <cite>Bar</cite> registered:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bar_instance</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bar_instance</span><span class="p">)</span>
<span class="go">Bar(value=42)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.ForceRouter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">ForceRouter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">laws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/forces/router.html#ForceRouter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceRouter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForceModel</span></code></a></p>
<p>Static species-to-force lookup table.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceRouter.table">
<span class="sig-name descname"><span class="pre">table</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.ForceRouter.table" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceRouter.from_dict">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="jaxdem.forces.router.html#jaxdem.forces.router.ForceRouter" title="jaxdem.forces.router.ForceRouter"><span class="pre">ForceRouter</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/router.py#L37-L44"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/router.html#ForceRouter.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceRouter.from_dict" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceRouter.force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/router.py#L46-L59"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/router.html#ForceRouter.force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceRouter.force" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceRouter.energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/router.py#L61-L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/router.html#ForceRouter.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceRouter.energy" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.LawCombiner">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">LawCombiner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">laws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><span class="pre">ForceModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/forces/law_combiner.html#LawCombiner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.LawCombiner" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.forces.html#jaxdem.forces.ForceModel" title="jaxdem.forces.ForceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForceModel</span></code></a></p>
<p>Sum a tuple of elementary force laws.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.LawCombiner.force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/law_combiner.py#L38-L55"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/law_combiner.html#LawCombiner.force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.LawCombiner.force" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.LawCombiner.energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/law_combiner.py#L57-L71"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/law_combiner.html#LawCombiner.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.LawCombiner.energy" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.ForceManager">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.</span></span><span class="sig-name descname"><span class="pre">ForceManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gravity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_force_com</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_com_force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_functions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_functions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">EnergyFunction</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manage custom force contributions external to the collider.
It also accumulates forces in the state after collider application, accounting for rigid bodies.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.gravity">
<span class="sig-name descname"><span class="pre">gravity</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.ForceManager.gravity" title="Link to this definition">#</a></dt>
<dd><p>Constant acceleration applied to all particles. Shape <code class="docutils literal notranslate"><span class="pre">(dim,)</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.external_force">
<span class="sig-name descname"><span class="pre">external_force</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.ForceManager.external_force" title="Link to this definition">#</a></dt>
<dd><p>Accumulated external force applied to all particles (at particle position).
This buffer is cleared when <a class="reference internal" href="#jaxdem.ForceManager.apply" title="jaxdem.ForceManager.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> is invoked.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.external_force_com">
<span class="sig-name descname"><span class="pre">external_force_com</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.ForceManager.external_force_com" title="Link to this definition">#</a></dt>
<dd><p>Accumulated external force applied to Center of Mass (does not induce torque).
This buffer is cleared when <a class="reference internal" href="#jaxdem.ForceManager.apply" title="jaxdem.ForceManager.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> is invoked.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.external_torque">
<span class="sig-name descname"><span class="pre">external_torque</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></span><a class="headerlink" href="#jaxdem.ForceManager.external_torque" title="Link to this definition">#</a></dt>
<dd><p>Accumulated external torque applied to all particles. This
buffer is cleared when <a class="reference internal" href="#jaxdem.ForceManager.apply" title="jaxdem.ForceManager.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> is invoked.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.is_com_force">
<span class="sig-name descname"><span class="pre">is_com_force</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.ForceManager.is_com_force" title="Link to this definition">#</a></dt>
<dd><p>Boolean array corresponding to <code class="docutils literal notranslate"><span class="pre">force_functions</span></code> with shape <code class="docutils literal notranslate"><span class="pre">(n_forces,)</span></code>.
If True, the force is applied to the Center of Mass (no induced torque).
If False, the force is applied to the constituent particle (induces torque via lever arm).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.force_functions">
<span class="sig-name descname"><span class="pre">force_functions</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.ForceManager.force_functions" title="Link to this definition">#</a></dt>
<dd><p>Tuple of callables with signature <code class="docutils literal notranslate"><span class="pre">(pos,</span> <span class="pre">state,</span> <span class="pre">system)</span></code> returning
per-particle force and torque arrays.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.ForceManager.energy_functions">
<span class="sig-name descname"><span class="pre">energy_functions</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">EnergyFunction</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jaxdem.ForceManager.energy_functions" title="Link to this definition">#</a></dt>
<dd><p>Tuple of callables (or None) with signature <code class="docutils literal notranslate"><span class="pre">(pos,</span> <span class="pre">state,</span> <span class="pre">system)</span></code> returning
per-particle potential energy arrays. Corresponds to <code class="docutils literal notranslate"><span class="pre">force_functions</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.create">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_functions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">EnergyFunction</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ForceFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">EnergyFunction</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.ForceManager" title="jaxdem.ForceManager"><span class="pre">ForceManager</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L84-L196"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.create" title="Link to this definition">#</a></dt>
<dd><p>Create a <a class="reference internal" href="#jaxdem.ForceManager" title="jaxdem.ForceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForceManager</span></code></a> for a state with the given shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_shape</strong> – Shape of the state position array, typically <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">dim)</span></code>.</p></li>
<li><p><strong>gravity</strong> – Optional initial gravitational acceleration. Defaults to zeros of shape <code class="docutils literal notranslate"><span class="pre">(dim,)</span></code>.</p></li>
<li><p><strong>force_functions</strong> – <p>Sequence of callables or tuples. Supported formats:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ForceFunc</span></code>: Applied at particle, no potential energy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(ForceFunc,</span> <span class="pre">bool)</span></code>: Boolean specifies if it is a COM force.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(ForceFunc,</span> <span class="pre">EnergyFunc)</span></code>: Includes potential energy function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(ForceFunc,</span> <span class="pre">EnergyFunc,</span> <span class="pre">bool)</span></code>: Includes energy and COM specifier.</p></li>
</ul>
<p>Signature of ForceFunc: <code class="docutils literal notranslate"><span class="pre">(pos,</span> <span class="pre">state,</span> <span class="pre">system)</span> <span class="pre">-&gt;</span> <span class="pre">(Force,</span> <span class="pre">Torque)</span></code>
Signature of EnergyFunc: <code class="docutils literal notranslate"><span class="pre">(pos,</span> <span class="pre">state,</span> <span class="pre">system)</span> <span class="pre">-&gt;</span> <span class="pre">Energy</span></code></p>
<p>Supported formats for force_functions items:
- func                  -&gt; (func, None, False)
- (func,)               -&gt; (func, None, False)
- (func, bool)          -&gt; (func, None, bool)
- (func, energy)        -&gt; (func, energy, False)
- (func, energy, bool)  -&gt; (func, energy, bool)
- (func, None, bool)    -&gt; (func, None, bool)</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.add_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_com</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L198-L225"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.add_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.add_force" title="Link to this definition">#</a></dt>
<dd><p>Accumulate an external force to be applied on the next <code class="docutils literal notranslate"><span class="pre">apply</span></code> call for all particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
<li><p><strong>force</strong> (<em>jax.Array</em>) – External force to be added to all particles in the current order.</p></li>
<li><p><strong>is_com</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, force is applied to Center of Mass (no induced torque).
If False (default), force is applied to Particle Position (induces torque).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.add_force_at">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add_force_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_com</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L227-L263"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.add_force_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.add_force_at" title="Link to this definition">#</a></dt>
<dd><p>Add an external force to particles with ID=idx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
<li><p><strong>force</strong> (<em>jax.Array</em>) – External force to be added to particles with ID=idx.</p></li>
<li><p><strong>idx</strong> (<em>jax.Array</em>) – ID of the particles affected by the external force.</p></li>
<li><p><strong>is_com</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, force is applied to Center of Mass (no induced torque).
If False (default), force is applied to Particle Position (induces torque).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.add_torque">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add_torque</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L265-L286"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.add_torque"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.add_torque" title="Link to this definition">#</a></dt>
<dd><p>Accumulate an external torque to be applied on the next <code class="docutils literal notranslate"><span class="pre">apply</span></code> call for all particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
<li><p><strong>torque</strong> (<em>jax.Array</em>) – External torque to be added to all particles in the current order..</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.add_torque_at">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">add_torque_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">torque</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L288-L320"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.add_torque_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.add_torque_at" title="Link to this definition">#</a></dt>
<dd><p>Add an external torque to particles with ID=idx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
<li><p><strong>torque</strong> (<em>jax.Array</em>) – External torque to be added to particles with ID=idx.</p></li>
<li><p><strong>idx</strong> (<em>jax.Array</em>) – ID of the particles affected by the external force.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.apply">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L322-L400"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.apply" title="Link to this definition">#</a></dt>
<dd><p>Accumulate managed per-particle contributions on top of collider/contact forces,
then perform final clump aggregation + broadcast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – Simulation system configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated state and system after one time step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.ForceManager.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/forces/force_manager.py#L402-L453"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/forces/force_manager.html#ForceManager.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.ForceManager.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Compute the total potential energy of the system.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The energy of clump members is divided by the number of spheres in the clump.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A scalar JAX array representing the total potential energy of each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p class="rubric">Modules</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.analysis.html#module-jaxdem.analysis" title="jaxdem.analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">analysis</span></code></a></p></td>
<td><p>Post-processing / analysis utilities.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.bonded_forces.html#module-jaxdem.bonded_forces" title="jaxdem.bonded_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bonded_forces</span></code></a></p></td>
<td><p>Bonded-force interfaces independent of the collider.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.colliders.html#module-jaxdem.colliders" title="jaxdem.colliders"><code class="xref py py-obj docutils literal notranslate"><span class="pre">colliders</span></code></a></p></td>
<td><p>Collision-detection interfaces and implementations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.domains.html#module-jaxdem.domains" title="jaxdem.domains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domains</span></code></a></p></td>
<td><p>Simulation domains and boundary-condition implementations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.factory.html#module-jaxdem.factory" title="jaxdem.factory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">factory</span></code></a></p></td>
<td><p>The factory defines and instantiates specific simulation components.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.forces.html#module-jaxdem.forces" title="jaxdem.forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forces</span></code></a></p></td>
<td><p>Force-law interfaces.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.integrators.html#module-jaxdem.integrators" title="jaxdem.integrators"><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrators</span></code></a></p></td>
<td><p>Time-integration interfaces and implementations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.material_matchmakers.html#module-jaxdem.material_matchmakers" title="jaxdem.material_matchmakers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">material_matchmakers</span></code></a></p></td>
<td><p>Material mix rules and implementations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.materials.html#module-jaxdem.materials" title="jaxdem.materials"><code class="xref py py-obj docutils literal notranslate"><span class="pre">materials</span></code></a></p></td>
<td><p>Interface for defining materials and the MaterialTable.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.minimizers.html#module-jaxdem.minimizers" title="jaxdem.minimizers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimizers</span></code></a></p></td>
<td><p>Energy-minimizer interfaces and implementations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.rl.html#module-jaxdem.rl" title="jaxdem.rl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rl</span></code></a></p></td>
<td><p>JaxDEM reinforcement learning (RL) module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.state.html#module-jaxdem.state" title="jaxdem.state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state</span></code></a></p></td>
<td><p>Defines the simulation State.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.system.html#module-jaxdem.system" title="jaxdem.system"><code class="xref py py-obj docutils literal notranslate"><span class="pre">system</span></code></a></p></td>
<td><p>Defines the simulation configuration and the tooling for driving the simulation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.utils.html#module-jaxdem.utils" title="jaxdem.utils"><code class="xref py py-obj docutils literal notranslate"><span class="pre">utils</span></code></a></p></td>
<td><p>Utility functions used to set up simulations and analyze the output.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.writers.html#module-jaxdem.writers" title="jaxdem.writers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">writers</span></code></a></p></td>
<td><p>Interface for defining data writers.</p></td>
</tr>
</tbody>
</table>
</div>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../api.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">API reference</p>
      </div>
    </a>
    <a class="right-next"
       href="jaxdem.analysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">jaxdem.analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State"><code class="docutils literal notranslate"><span class="pre">State</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.pos_c"><code class="docutils literal notranslate"><span class="pre">State.pos_c</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.pos_p"><code class="docutils literal notranslate"><span class="pre">State.pos_p</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.vel"><code class="docutils literal notranslate"><span class="pre">State.vel</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.force"><code class="docutils literal notranslate"><span class="pre">State.force</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.q"><code class="docutils literal notranslate"><span class="pre">State.q</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.ang_vel"><code class="docutils literal notranslate"><span class="pre">State.ang_vel</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.torque"><code class="docutils literal notranslate"><span class="pre">State.torque</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.rad"><code class="docutils literal notranslate"><span class="pre">State.rad</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.volume"><code class="docutils literal notranslate"><span class="pre">State.volume</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.mass"><code class="docutils literal notranslate"><span class="pre">State.mass</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.inertia"><code class="docutils literal notranslate"><span class="pre">State.inertia</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.clump_id"><code class="docutils literal notranslate"><span class="pre">State.clump_id</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.bond_id"><code class="docutils literal notranslate"><span class="pre">State.bond_id</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.unique_id"><code class="docutils literal notranslate"><span class="pre">State.unique_id</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.mat_id"><code class="docutils literal notranslate"><span class="pre">State.mat_id</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.species_id"><code class="docutils literal notranslate"><span class="pre">State.species_id</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.fixed"><code class="docutils literal notranslate"><span class="pre">State.fixed</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.N"><code class="docutils literal notranslate"><span class="pre">State.N</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.dim"><code class="docutils literal notranslate"><span class="pre">State.dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.shape"><code class="docutils literal notranslate"><span class="pre">State.shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.batch_size"><code class="docutils literal notranslate"><span class="pre">State.batch_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.pos"><code class="docutils literal notranslate"><span class="pre">State.pos</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.is_valid"><code class="docutils literal notranslate"><span class="pre">State.is_valid</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.create"><code class="docutils literal notranslate"><span class="pre">State.create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.merge"><code class="docutils literal notranslate"><span class="pre">State.merge()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.add"><code class="docutils literal notranslate"><span class="pre">State.add()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.stack"><code class="docutils literal notranslate"><span class="pre">State.stack()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.unstack"><code class="docutils literal notranslate"><span class="pre">State.unstack()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.State.add_clump"><code class="docutils literal notranslate"><span class="pre">State.add_clump()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.linear_integrator"><code class="docutils literal notranslate"><span class="pre">System.linear_integrator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.rotation_integrator"><code class="docutils literal notranslate"><span class="pre">System.rotation_integrator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.collider"><code class="docutils literal notranslate"><span class="pre">System.collider</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.domain"><code class="docutils literal notranslate"><span class="pre">System.domain</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.force_manager"><code class="docutils literal notranslate"><span class="pre">System.force_manager</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.bonded_force_model"><code class="docutils literal notranslate"><span class="pre">System.bonded_force_model</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.force_model"><code class="docutils literal notranslate"><span class="pre">System.force_model</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.mat_table"><code class="docutils literal notranslate"><span class="pre">System.mat_table</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.dt"><code class="docutils literal notranslate"><span class="pre">System.dt</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.time"><code class="docutils literal notranslate"><span class="pre">System.time</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.dim"><code class="docutils literal notranslate"><span class="pre">System.dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.step_count"><code class="docutils literal notranslate"><span class="pre">System.step_count</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.key"><code class="docutils literal notranslate"><span class="pre">System.key</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.interact_same_bond_id"><code class="docutils literal notranslate"><span class="pre">System.interact_same_bond_id</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.create"><code class="docutils literal notranslate"><span class="pre">System.create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.trajectory_rollout"><code class="docutils literal notranslate"><span class="pre">System.trajectory_rollout()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.step"><code class="docutils literal notranslate"><span class="pre">System.step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.stack"><code class="docutils literal notranslate"><span class="pre">System.stack()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.System.unstack"><code class="docutils literal notranslate"><span class="pre">System.unstack()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter"><code class="docutils literal notranslate"><span class="pre">VTKWriter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.writers"><code class="docutils literal notranslate"><span class="pre">VTKWriter.writers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.directory"><code class="docutils literal notranslate"><span class="pre">VTKWriter.directory</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.binary"><code class="docutils literal notranslate"><span class="pre">VTKWriter.binary</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.clean"><code class="docutils literal notranslate"><span class="pre">VTKWriter.clean</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.save_every"><code class="docutils literal notranslate"><span class="pre">VTKWriter.save_every</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.max_queue_size"><code class="docutils literal notranslate"><span class="pre">VTKWriter.max_queue_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.max_workers"><code class="docutils literal notranslate"><span class="pre">VTKWriter.max_workers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.close"><code class="docutils literal notranslate"><span class="pre">VTKWriter.close()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.block_until_ready"><code class="docutils literal notranslate"><span class="pre">VTKWriter.block_until_ready()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKWriter.save"><code class="docutils literal notranslate"><span class="pre">VTKWriter.save()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKBaseWriter"><code class="docutils literal notranslate"><span class="pre">VTKBaseWriter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.VTKBaseWriter.write"><code class="docutils literal notranslate"><span class="pre">VTKBaseWriter.write()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.directory"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.directory</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.max_to_keep"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.max_to_keep</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.save_every"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.save_every</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.checkpointer"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.checkpointer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.save"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.save()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.block_until_ready"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.block_until_ready()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointWriter.close"><code class="docutils literal notranslate"><span class="pre">CheckpointWriter.close()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader.directory"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader.directory</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader.checkpointer"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader.checkpointer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader.load"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader.load()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader.latest_step"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader.latest_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader.block_until_ready"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader.block_until_ready()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointLoader.close"><code class="docutils literal notranslate"><span class="pre">CheckpointLoader.close()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.directory"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.directory</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.max_to_keep"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.max_to_keep</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.save_every"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.save_every</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.checkpointer"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.checkpointer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.clean"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.clean</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.save"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.save()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.block_until_ready"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.block_until_ready()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelWriter.close"><code class="docutils literal notranslate"><span class="pre">CheckpointModelWriter.close()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader.directory"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader.directory</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader.checkpointer"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader.checkpointer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader.load"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader.load()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader.latest_step"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader.latest_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader.block_until_ready"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader.block_until_ready()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.CheckpointModelLoader.close"><code class="docutils literal notranslate"><span class="pre">CheckpointModelLoader.close()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Material"><code class="docutils literal notranslate"><span class="pre">Material</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Material.density"><code class="docutils literal notranslate"><span class="pre">Material.density</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialTable"><code class="docutils literal notranslate"><span class="pre">MaterialTable</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialTable.props"><code class="docutils literal notranslate"><span class="pre">MaterialTable.props</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialTable.pair"><code class="docutils literal notranslate"><span class="pre">MaterialTable.pair</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialTable.matcher"><code class="docutils literal notranslate"><span class="pre">MaterialTable.matcher</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialTable.from_materials"><code class="docutils literal notranslate"><span class="pre">MaterialTable.from_materials()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialMatchmaker"><code class="docutils literal notranslate"><span class="pre">MaterialMatchmaker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.MaterialMatchmaker.get_effective_property"><code class="docutils literal notranslate"><span class="pre">MaterialMatchmaker.get_effective_property()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceModel"><code class="docutils literal notranslate"><span class="pre">ForceModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceModel.laws"><code class="docutils literal notranslate"><span class="pre">ForceModel.laws</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceModel.force"><code class="docutils literal notranslate"><span class="pre">ForceModel.force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceModel.energy"><code class="docutils literal notranslate"><span class="pre">ForceModel.energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceModel.required_material_properties"><code class="docutils literal notranslate"><span class="pre">ForceModel.required_material_properties</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.BondedForceModel"><code class="docutils literal notranslate"><span class="pre">BondedForceModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.BondedForceModel.force_and_energy_fns"><code class="docutils literal notranslate"><span class="pre">BondedForceModel.force_and_energy_fns</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.BondedForceModel.merge"><code class="docutils literal notranslate"><span class="pre">BondedForceModel.merge()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.BondedForceModel.add"><code class="docutils literal notranslate"><span class="pre">BondedForceModel.add()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.BondedForceModel.stack"><code class="docutils literal notranslate"><span class="pre">BondedForceModel.stack()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.BondedForceModel.unstack"><code class="docutils literal notranslate"><span class="pre">BondedForceModel.unstack()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Integrator"><code class="docutils literal notranslate"><span class="pre">Integrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Integrator.step_before_force"><code class="docutils literal notranslate"><span class="pre">Integrator.step_before_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Integrator.step_after_force"><code class="docutils literal notranslate"><span class="pre">Integrator.step_after_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Integrator.initialize"><code class="docutils literal notranslate"><span class="pre">Integrator.initialize()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.LinearIntegrator"><code class="docutils literal notranslate"><span class="pre">LinearIntegrator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.RotationIntegrator"><code class="docutils literal notranslate"><span class="pre">RotationIntegrator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Minimizer"><code class="docutils literal notranslate"><span class="pre">Minimizer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.LinearMinimizer"><code class="docutils literal notranslate"><span class="pre">LinearMinimizer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.RotationMinimizer"><code class="docutils literal notranslate"><span class="pre">RotationMinimizer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Collider"><code class="docutils literal notranslate"><span class="pre">Collider</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Collider.compute_force"><code class="docutils literal notranslate"><span class="pre">Collider.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Collider.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">Collider.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Collider.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">Collider.create_neighbor_list()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain"><code class="docutils literal notranslate"><span class="pre">Domain</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.box_size"><code class="docutils literal notranslate"><span class="pre">Domain.box_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.anchor"><code class="docutils literal notranslate"><span class="pre">Domain.anchor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.periodic"><code class="docutils literal notranslate"><span class="pre">Domain.periodic</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.Create"><code class="docutils literal notranslate"><span class="pre">Domain.Create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.displacement"><code class="docutils literal notranslate"><span class="pre">Domain.displacement()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.apply"><code class="docutils literal notranslate"><span class="pre">Domain.apply()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Domain.shift"><code class="docutils literal notranslate"><span class="pre">Domain.shift()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Factory"><code class="docutils literal notranslate"><span class="pre">Factory</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Factory.registry_name"><code class="docutils literal notranslate"><span class="pre">Factory.registry_name()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Factory.type_name"><code class="docutils literal notranslate"><span class="pre">Factory.type_name</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Factory.register"><code class="docutils literal notranslate"><span class="pre">Factory.register()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.Factory.create"><code class="docutils literal notranslate"><span class="pre">Factory.create()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceRouter"><code class="docutils literal notranslate"><span class="pre">ForceRouter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceRouter.table"><code class="docutils literal notranslate"><span class="pre">ForceRouter.table</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceRouter.from_dict"><code class="docutils literal notranslate"><span class="pre">ForceRouter.from_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceRouter.force"><code class="docutils literal notranslate"><span class="pre">ForceRouter.force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceRouter.energy"><code class="docutils literal notranslate"><span class="pre">ForceRouter.energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.LawCombiner"><code class="docutils literal notranslate"><span class="pre">LawCombiner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.LawCombiner.force"><code class="docutils literal notranslate"><span class="pre">LawCombiner.force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.LawCombiner.energy"><code class="docutils literal notranslate"><span class="pre">LawCombiner.energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager"><code class="docutils literal notranslate"><span class="pre">ForceManager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.gravity"><code class="docutils literal notranslate"><span class="pre">ForceManager.gravity</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.external_force"><code class="docutils literal notranslate"><span class="pre">ForceManager.external_force</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.external_force_com"><code class="docutils literal notranslate"><span class="pre">ForceManager.external_force_com</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.external_torque"><code class="docutils literal notranslate"><span class="pre">ForceManager.external_torque</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.is_com_force"><code class="docutils literal notranslate"><span class="pre">ForceManager.is_com_force</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.force_functions"><code class="docutils literal notranslate"><span class="pre">ForceManager.force_functions</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.energy_functions"><code class="docutils literal notranslate"><span class="pre">ForceManager.energy_functions</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.create"><code class="docutils literal notranslate"><span class="pre">ForceManager.create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.add_force"><code class="docutils literal notranslate"><span class="pre">ForceManager.add_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.add_force_at"><code class="docutils literal notranslate"><span class="pre">ForceManager.add_force_at()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.add_torque"><code class="docutils literal notranslate"><span class="pre">ForceManager.add_torque()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.add_torque_at"><code class="docutils literal notranslate"><span class="pre">ForceManager.add_torque_at()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.apply"><code class="docutils literal notranslate"><span class="pre">ForceManager.apply()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.ForceManager.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">ForceManager.compute_potential_energy()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Carlos Andres del Valle.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>