
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>jaxdem.colliders &#8212; JaxDEM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=039bb74b" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/jaxdem.colliders';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="jaxdem.colliders.cell_list" href="jaxdem.colliders.cell_list.html" />
    <link rel="prev" title="jaxdem.bonded_forces.deformable_particle" href="jaxdem.bonded_forces.deformable_particle.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">JaxDEM</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribution_guide/index.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cdelv/JaxDEM" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribution_guide/index.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cdelv/JaxDEM" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="jaxdem.html">jaxdem</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="jaxdem.analysis.html">jaxdem.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.bonded_forces.html">jaxdem.bonded_forces</a></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">jaxdem.colliders</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.cell_list.html">jaxdem.colliders.cell_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.naive.html">jaxdem.colliders.naive</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.neighbor_list.html">jaxdem.colliders.neighbor_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.sweep_and_prune.html">jaxdem.colliders.sweep_and_prune</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.domains.html">jaxdem.domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.factory.html">jaxdem.factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.forces.html">jaxdem.forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.integrators.html">jaxdem.integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.material_matchmakers.html">jaxdem.material_matchmakers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.materials.html">jaxdem.materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.minimizers.html">jaxdem.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.rl.html">jaxdem.rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.state.html">jaxdem.state</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.system.html">jaxdem.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.utils.html">jaxdem.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.writers.html">jaxdem.writers</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="jaxdem.rl.html">jaxdem.rl</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items" aria-labelledby="pst-indices-navigation-heading-2">
  <p id="pst-indices-navigation-heading-2" class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../../genindex.html"
             accesskey="I">General Index</a>
        </li>
        <li class="toctree-l1">
          <a class="reference internal" href="../../py-modindex.html">Python Module Index</a>
        </li>
  </ul>
</nav></div>
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">API reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="jaxdem.html" class="nav-link">jaxdem</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">jaxdem.colliders</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-jaxdem.colliders">
<span id="jaxdem-colliders"></span><h1>jaxdem.colliders<a class="headerlink" href="#module-jaxdem.colliders" title="Link to this heading">#</a></h1>
<p>Collision-detection interfaces and implementations.</p>
<p class="rubric">Functions</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#jaxdem.colliders.valid_interaction_mask" title="jaxdem.colliders.valid_interaction_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">valid_interaction_mask</span></code></a>(clump_i, clump_j, ...)</p></td>
<td><p>Pair mask shared by all colliders.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Classes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Collider</span></code></a>()</p></td>
<td><p>The base interface for defining how contact detection and force computations are performed in a simulation.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.Collider">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.</span></span><span class="sig-name descname"><span class="pre">Collider</span></span><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.Collider" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.factory.html#jaxdem.factory.Factory" title="jaxdem.factory.Factory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>The base interface for defining how contact detection and force computations are performed in a simulation.</p>
<p>Concrete subclasses of <cite>Collider</cite> implement the specific algorithms for calculating the interactions.</p>
<p class="rubric">Notes</p>
<p>Self-interaction (i.e., calling the force/energy computation for <cite>i=j</cite>) is allowed,
and the underlying <cite>force_model</cite> is responsible for correctly handling or
ignoring this case.</p>
<p class="rubric">Example</p>
<p>To define a custom collider, inherit from <cite>Collider</cite>, register it and implement its abstract methods:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@Collider</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;CustomCollider&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">register_dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">CustomCollider</span><span class="p">(</span><span class="n">Collider</span><span class="p">):</span>
<span class="go">        ...</span>
</pre></div>
</div>
<p>Then, instantiate it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jaxdem</span><span class="o">.</span><span class="n">Collider</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;CustomCollider&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">custom_collider_kw</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.Collider.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L50-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.Collider.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to compute the total force acting on each particle in the simulation.</p>
<p>Implementations should calculate inter-particle forces and torques based on the current
<cite>state</cite> and <cite>system</cite> configuration, then update the <cite>force</cite> and <cite>torque</cite> attributes of the
<cite>state</cite> object with the resulting total force and torque for each particle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <cite>State</cite> object (with computed forces) and the <cite>System</cite> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates state and system</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.Collider.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L80-L108"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.Collider.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Abstract method to compute the total potential energy of the system.</p>
<p>Implementations should calculate the sum per particle of all potential energies
present in the system based on the current <cite>state</cite> and <cite>system</cite> configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A scalar JAX array representing the total potential energy of each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential_energy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">collider</span><span class="o">.</span><span class="n">compute_potential_energy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Potential energy per particle: </span><span class="si">{</span><span class="n">potential_energy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">potential_energy</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (N,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.Collider.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L110-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#Collider.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.Collider.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Build a neighbor list for the current collider.</p>
<p>This is primarily used by neighbor-list-based algorithms and diagnostics.
Implementations should match the cell-list semantics:</p>
<ul class="simple">
<li><p>Returns a neighbor list of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">max_neighbors)</span></code> padded with <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p>Neighbor indices must refer to the returned (possibly sorted) <code class="docutils literal notranslate"><span class="pre">state</span></code>.</p></li>
<li><p>Also returns an <code class="docutils literal notranslate"><span class="pre">overflow</span></code> boolean flag (True if any particle exceeded
<code class="docutils literal notranslate"><span class="pre">max_neighbors</span></code> neighbors within the cutoff).</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.NaiveSimulator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.</span></span><span class="sig-name descname"><span class="pre">NaiveSimulator</span></span><a class="reference internal" href="../../_modules/jaxdem/colliders/naive.html#NaiveSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NaiveSimulator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collider</span></code></a></p>
<p>Implementation that computes forces and potential energies using a naive <span class="math notranslate nohighlight">\(O(N^2)\)</span> all-pairs interaction loop.</p>
<p class="rubric">Notes</p>
<p>Due to its <span class="math notranslate nohighlight">\(O(N^2)\)</span> complexity, <cite>NaiveSimulator</cite> is suitable for simulations
with a relatively small number of particles. For larger systems, a more
efficient spatial partitioning collider should be used. However, this collider should be the fastest
option for small systems (<span class="math notranslate nohighlight">\(&lt;1k-5k\)</span> spheres depending on the GPU).</p>
<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NaiveSimulator.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/naive.py#L37-L76"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/naive.html#NaiveSimulator.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NaiveSimulator.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Computes the potential energy associated with each particle using a naive <span class="math notranslate nohighlight">\(O(N^2)\)</span> all-pairs loop.</p>
<p>This method iterates over all particle pairs (i, j) and sums the potential energy
contributions computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One-dimensional array containing the total potential energy contribution for each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NaiveSimulator.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/naive.py#L78-L144"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/naive.html#NaiveSimulator.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NaiveSimulator.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Computes a neighbor list using a naive <span class="math notranslate nohighlight">\(O(N^2)\)</span> all-pairs search.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – The interaction radius (force cutoff).</p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em>) – Maximum number of neighbors to store per particle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- state: The simulation state.
- system: The simulation system.
- neighbor_list: Array of shape (N, max_neighbors) containing neighbor indices.
- overflow: Boolean flag indicating if any particle exceeded <code class="docutils literal notranslate"><span class="pre">max_neighbors</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NaiveSimulator.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/naive.py#L146-L196"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/naive.html#NaiveSimulator.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NaiveSimulator.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Computes the total force acting on each particle using a naive <span class="math notranslate nohighlight">\(O(N^2)\)</span> all-pairs loop.</p>
<p>This method sums the force contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code> and updates the particle forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <code class="docutils literal notranslate"><span class="pre">State</span></code> object with computed forces
and the unmodified <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates state and system</p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.</span></span><span class="sig-name descname"><span class="pre">StaticCellList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_occupancy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.StaticCellList" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collider</span></code></a></p>
<p>Implicit cell-list (spatial hashing) collider.</p>
<p>This collider accelerates short-range pair interactions by partitioning the
domain into a regular grid of cubic/square cells of side length <code class="docutils literal notranslate"><span class="pre">cell_size</span></code>.
Each particle is assigned to a cell, particles are sorted by cell hash, and
interactions are evaluated only against particles in the same or neighboring
cells given by <code class="docutils literal notranslate"><span class="pre">neighbor_mask</span></code>. The cell list is <em>implicit</em> because we never
store per-cell particle lists explicitly; instead, we exploit the sorted hashes
and fixed <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> to probe neighbors in-place.</p>
<p>This collider is ideal for systems of spheres with minimum polydispersity and no dramatic overlaps.
In this case, it might be even faster than the default cell list. However, it’s not recommended for systems
with clumps, dramatic overlaps, as it might skip some contacts, or polydispersity, as it hinders the performance of this collider.</p>
<section id="complexity">
<h2>Complexity<a class="headerlink" href="#complexity" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Time: <span class="math notranslate nohighlight">\(O(N)\)</span> - <span class="math notranslate nohighlight">\(O(N \log N)\)</span> from sorting, plus <span class="math notranslate nohighlight">\(O(N M K)\)</span> for neighbor
probing (M = number of neighbor cells, K = <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code>). The state is close to sorted every frame.</p></li>
<li><p>Memory: <span class="math notranslate nohighlight">\(O(N)\)</span>.</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> is an upper bound on particles per cell.
If a cell contains more than this many particles, some interactions
might be missed (you should choose <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> so this does not happen).</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.neighbor_mask">
<span class="sig-name descname"><span class="pre">neighbor_mask</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.StaticCellList.neighbor_mask" title="Link to this definition">#</a></dt>
<dd><p>Integer offsets defining the neighbor stencil.</p>
<p>Shape is <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">dim)</span></code>, where each row is a displacement in cell coordinates.
For <code class="docutils literal notranslate"><span class="pre">search_range=1</span></code> in 2D this is the 3×3 Moore neighborhood (M=9);
in 3D this is the 3×3×3 neighborhood (M=27).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.cell_size">
<span class="sig-name descname"><span class="pre">cell_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.StaticCellList.cell_size" title="Link to this definition">#</a></dt>
<dd><p>Linear size of a grid cell (scalar).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.max_occupancy">
<span class="sig-name descname"><span class="pre">max_occupancy</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jaxdem.colliders.StaticCellList.max_occupancy" title="Link to this definition">#</a></dt>
<dd><p>Maximum number of particles assumed to occupy a single cell.</p>
<p>The algorithm probes exactly <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> entries starting from the
first particle in a neighbor cell. This should be set high enough that
real cells rarely exceed it; otherwise contacts/energy will be undercounted.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.Create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_occupancy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L559-L671"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.Create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.StaticCellList.Create" title="Link to this definition">#</a></dt>
<dd><p>Creates a StaticCellList collider with robust defaults.</p>
<p>Defaults are chosen to avoid missing any contacts while keeping the
neighbor stencil and assumed cell occupancy as small as possible given
available information from <code class="docutils literal notranslate"><span class="pre">state</span></code>. For this we assume no overlap between spheres.</p>
<p>The cost of computing forces for one particle is determined by the number
of neighboring cells to check and the occupancy of each cell. This cost
can be estimated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{cost} = (2R + 1)^{dim} \cdot \text{max_occupancy} \\
\text{cost} = (2R + 1)^{dim} \cdot \left(\left\lceil \frac{L^{dim}}{V_{min}} \right\rceil +2 \right)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the search radius, <span class="math notranslate nohighlight">\(L\)</span> is the cell size, and
<span class="math notranslate nohighlight">\(V_{min}\)</span> is the volume of the smallest element. We assume
<span class="math notranslate nohighlight">\(V_{min}\)</span> to be the volume of the smallest sphere, without
accounting for the packing fraction, to provide a conservative upper bound.
The search radius <span class="math notranslate nohighlight">\(R\)</span> is computed as:</p>
<div class="math notranslate nohighlight">
\[R = \left\lceil \frac{2 r_{max}}{L} \right\rceil\]</div>
<p>By default, we choose the options that yield the lowest computational
cost: <span class="math notranslate nohighlight">\(L = 2 \cdot r_{max}\)</span> if <span class="math notranslate nohighlight">\(\alpha &lt; 2.5\)</span>, else <span class="math notranslate nohighlight">\(L = r_{max}/2\)</span>.</p>
<p>The complexity of searching neighbors is <span class="math notranslate nohighlight">\(O(N)\)</span>, where the choice
of cell size and <span class="math notranslate nohighlight">\(R\)</span> attempts to minimize the constant factor. The constant factor
grows with polydispersity (<span class="math notranslate nohighlight">\(\alpha\)</span>) as <span class="math notranslate nohighlight">\(O(\alpha^{dim})\)</span> with <span class="math notranslate nohighlight">\(\alpha = r_{max}/r_{min}\)</span>.
The cost for sorting and binary search remains <span class="math notranslate nohighlight">\(O(N \log N)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Reference state used to determine spatial dimension and default parameters.</p></li>
<li><p><strong>cell_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Cell edge length. If None, defaults to a value optimized for the
radius distribution.</p></li>
<li><p><strong>search_range</strong> (<em>int</em><em>, </em><em>optional</em>) – Neighbor range in cell units. If None, the smallest safe value is
computed such that <span class="math notranslate nohighlight">\(\text{search\_range} \cdot L \geq \text{cutoff}\)</span>.</p></li>
<li><p><strong>box_size</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Size of the periodic box used to ensure there are at least
<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">search_range</span> <span class="pre">+</span> <span class="pre">1</span></code> cells per axis. If None, these checks are
skipped.</p></li>
<li><p><strong>max_occupancy</strong> (<em>int</em><em>, </em><em>optional</em>) – Assumed maximum particles per cell. If None, estimated from a
conservative packing upper bound using the smallest radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured collider instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CellList</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L673-L706"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.StaticCellList.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Computes the total force acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the force contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code> and updates the particle forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <code class="docutils literal notranslate"><span class="pre">State</span></code> object with computed forces and the unmodified <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates <code class="docutils literal notranslate"><span class="pre">state</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L708-L735"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.StaticCellList.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Computes the potential energy acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the energy contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array containing the potential energy for each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.StaticCellList.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L737-L822"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.StaticCellList.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Computes the list of neighbors for each particle. The shape of the list is (N, max_neighbors).
If a particle has less neighbors than max_neighbors, the list is padded with -1. The indices of the list
correspond to the indices of the returned sorted state.</p>
<p>Note that no neighbors further than cell_size * (1 + search_range) (how many neighbors to check in the cells)
can be found due to the nature of the cell list. If cutoff is greater than this value, the list might not
return the expected list. Note that if a cell contains more spheres than those specified in max_occupancy, there might be missing neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Search radius</p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em>) – Maximum number of neighbors to store per particle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sorted state, the system, the neighbor list, and a boolean flag for overflow.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.</span></span><span class="sig-name descname"><span class="pre">DynamicCellList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.DynamicCellList" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collider</span></code></a></p>
<p>Implicit cell-list (spatial hashing) collider using dynamic while-loops.</p>
<p>This collider accelerates short-range pair interactions by partitioning the
domain into a regular grid. Unlike the static cell list, this implementation
uses a dynamic <code class="docutils literal notranslate"><span class="pre">jax.lax.while_loop</span></code> to probe neighbor cells, which can be
more efficient with polydisperse systems or low packing fractions. It’s also useful for systems that
have a high occupancy per cell, for example, systems with clumps.</p>
<section id="id1">
<h2>Complexity<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Time: <span class="math notranslate nohighlight">\(O(N)\)</span> - <span class="math notranslate nohighlight">\(O(N \log N)\)</span> from sorting, plus <span class="math notranslate nohighlight">\(O(N M \langle K \rangle)\)</span>
for neighbor probing, where <span class="math notranslate nohighlight">\(\langle K \rangle\)</span> is the average cell occupancy. The state is close to sorted every frame.</p></li>
<li><p>Memory: <span class="math notranslate nohighlight">\(O(N)\)</span>.</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList.neighbor_mask">
<span class="sig-name descname"><span class="pre">neighbor_mask</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.DynamicCellList.neighbor_mask" title="Link to this definition">#</a></dt>
<dd><p>Integer offsets defining the neighbor stencil (M, dim).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList.cell_size">
<span class="sig-name descname"><span class="pre">cell_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.DynamicCellList.cell_size" title="Link to this definition">#</a></dt>
<dd><p>Linear size of a grid cell (scalar).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList.Create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L851-L945"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.Create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.DynamicCellList.Create" title="Link to this definition">#</a></dt>
<dd><p>Creates a CellList collider with robust defaults.</p>
<p>Defaults are chosen to avoid missing any contacts while keeping the
neighbor stencil and assumed cell occupancy as small as possible given
available information from <code class="docutils literal notranslate"><span class="pre">state</span></code>.</p>
<p>The cost of computing forces for one particle is determined by the number
of neighboring cells to check and the occupancy of each cell. This cost
can be estimated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{cost} = (2R + 1)^{dim} \cdot \text{max_occupancy} \\
\text{cost} = (2R + 1)^{dim} \cdot \left(\left\lceil \frac{L^{dim}}{V_{min}} \right\rceil +2 \right)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the search radius, <span class="math notranslate nohighlight">\(L\)</span> is the cell size, and
<span class="math notranslate nohighlight">\(V_{min}\)</span> is the volume of the smallest element. We assume
<span class="math notranslate nohighlight">\(V_{min}\)</span> to be the volume of the smallest sphere, without
accounting for the packing fraction, to provide a conservative upper bound.
The search radius <span class="math notranslate nohighlight">\(R\)</span> is computed as:</p>
<div class="math notranslate nohighlight">
\[R = \left\lceil \frac{2 r_{max}}{L} \right\rceil\]</div>
<p>By default, we choose the options that yield the lowest computational cost: <span class="math notranslate nohighlight">\(L = 2 \cdot r_{max}\)</span> if <span class="math notranslate nohighlight">\(\alpha &lt; 2.5\)</span>, else <span class="math notranslate nohighlight">\(L = r_{max}/2\)</span>.</p>
<p>The complexity of searching neighbors is <span class="math notranslate nohighlight">\(O(N)\)</span>, where the choice
of cell size and <span class="math notranslate nohighlight">\(R\)</span> attempts to minimize the constant factor. The constant factor
grows with polydispersity; however, the dynamic nature of the collider greatly minimizes polydispersity’s impact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Reference state used to determine spatial dimension and default parameters.</p></li>
<li><p><strong>cell_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Cell edge length. If None, defaults to a value optimized for the
radius distribution.</p></li>
<li><p><strong>box_size</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Size of the periodic box used to ensure there are at least 3 cells per axis.
If None, these checks are ignored and will lead to errors if violated.</p></li>
<li><p><strong>search_range</strong> (<em>int</em><em>, </em><em>optional</em>) – Neighbor range in cell units. If None, the smallest safe value is
computed such that <span class="math notranslate nohighlight">\(\text{search\_range} \cdot L \geq \text{cutoff}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured collider instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CellList</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L947-L982"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.DynamicCellList.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Computes the total force acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the force contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code> and updates the particle forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <code class="docutils literal notranslate"><span class="pre">State</span></code> object with computed forces and the unmodified <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates <code class="docutils literal notranslate"><span class="pre">state</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L984-L1011"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.DynamicCellList.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Computes the potential energy acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the energy contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array containing the potential energy for each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.DynamicCellList.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L1013-L1135"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.DynamicCellList.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Computes the list of neighbors for each particle. The shape of the list is (N, max_neighbors).
If a particle has less neighbors than max_neighbors, the list is padded with -1. The indices of the list
correspond to the indices of the returned sorted state.</p>
<p>Note that no neighbors further than cell_size * (1 + search_range) (how many neighbors to check in the cells)
can be found due to the nature of the cell list. If cutoff is greater than this value, the list might not
return the expected list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Search radius</p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em>) – Maximum number of neighbors to store per particle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sorted state, the system, the neighbor list, and a boolean flag for overflow.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.</span></span><span class="sig-name descname"><span class="pre">NeighborList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><span class="pre">Collider</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_build_times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overflow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/colliders/neighbor_list.html#NeighborList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NeighborList" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collider</span></code></a></p>
<p>Implementation of a Verlet neighbor list collider.</p>
<p>This collider caches a list of neighbors for every particle, significantly reducing
the number of distance calculations required at each time step. The list is only
rebuilt when the maximum displacement of any particle exceeds half of the specified
<code class="docutils literal notranslate"><span class="pre">skin</span></code> distance.</p>
<section id="id2">
<h2>Complexity<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Time: <span class="math notranslate nohighlight">\(O(N)\)</span> between rebuilds. Rebuild complexity depends on the underlying
<code class="docutils literal notranslate"><span class="pre">cell_list</span></code> collider (typically <span class="math notranslate nohighlight">\(O(N \log N)\)</span>).</p></li>
</ul>
<p class="rubric">Notes</p>
<p>You must provide a non-zero <code class="docutils literal notranslate"><span class="pre">skin</span></code> (e.g., 0.1 * radius) for this collider to
be efficient. If <code class="docutils literal notranslate"><span class="pre">skin</span> <span class="pre">=</span> <span class="pre">0</span></code>, the list is rebuilt every step, which is
computationally expensive.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.cell_list">
<span class="sig-name descname"><span class="pre">cell_list</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><span class="pre">Collider</span></a></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.cell_list" title="Link to this definition">#</a></dt>
<dd><p>The underlying collider used to build the list via <code class="docutils literal notranslate"><span class="pre">create_neighbor_list</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.neighbor_list">
<span class="sig-name descname"><span class="pre">neighbor_list</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Shape (N, max_neighbors). Contains the IDs of neighboring particles, padded with -1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.old_pos">
<span class="sig-name descname"><span class="pre">old_pos</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.old_pos" title="Link to this definition">#</a></dt>
<dd><p>Shape (N, dim). Positions of particles at the last build time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.n_build_times">
<span class="sig-name descname"><span class="pre">n_build_times</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.n_build_times" title="Link to this definition">#</a></dt>
<dd><p>Counter for how many times the list has been rebuilt.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.cutoff" title="Link to this definition">#</a></dt>
<dd><p>The interaction radius (force cutoff).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.skin">
<span class="sig-name descname"><span class="pre">skin</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.skin" title="Link to this definition">#</a></dt>
<dd><p>Buffer distance. The list is built with <code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">=</span> <span class="pre">cutoff</span> <span class="pre">+</span> <span class="pre">skin</span></code> and
rebuilt when <code class="docutils literal notranslate"><span class="pre">max_displacement</span> <span class="pre">&gt;</span> <span class="pre">skin</span> <span class="pre">/</span> <span class="pre">2</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.overflow">
<span class="sig-name descname"><span class="pre">overflow</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.overflow" title="Link to this definition">#</a></dt>
<dd><p>Boolean flag indicating if the neighbor list overflowed during build.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.max_neighbors">
<span class="sig-name descname"><span class="pre">max_neighbors</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jaxdem.colliders.NeighborList.max_neighbors" title="Link to this definition">#</a></dt>
<dd><p>Static buffer size for the neighbor list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.Create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safety_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_collider_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'CellList'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_collider_kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/neighbor_list.py#L77-L162"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/neighbor_list.html#NeighborList.Create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NeighborList.Create" title="Link to this definition">#</a></dt>
<dd><p>Creates a NeighborList collider.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The initial simulation state used to determine system dimensions and
particle count.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – The physical interaction cutoff radius.</p></li>
<li><p><strong>skin</strong> (<em>float</em><em>, </em><em>default 0.05</em>) – The buffer distance added to the cutoff for the neighbor list.
<strong>Must be &gt; 0.0 for performance.</strong></p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of neighbors to store per particle. If not provided,
it is estimated from the <code class="docutils literal notranslate"><span class="pre">number_density</span></code>.</p></li>
<li><p><strong>number_density</strong> (<em>float</em><em>, </em><em>default 1.0</em>) – Number density of the system used to estimate <code class="docutils literal notranslate"><span class="pre">max_neighbors</span></code> if
not explicitly provided.</p></li>
<li><p><strong>safety_factor</strong> (<em>float</em><em>, </em><em>default 1.2</em>) – Multiplier applied to the estimated number of neighbors to account
for fluctuations in local density.</p></li>
<li><p><strong>secondary_collider_type</strong> (<em>str</em><em>, </em><em>default &quot;CellList&quot;</em>) – Registered collider type used internally to build the neighbor lists.</p></li>
<li><p><strong>secondary_collider_kw</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>optional</em>) – Keyword arguments passed to the constructor of the internal collider.
If None, <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> is set to <code class="docutils literal notranslate"><span class="pre">cutoff</span> <span class="pre">+</span> <span class="pre">skin</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A configured NeighborList collider instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jaxdem.colliders.NeighborList" title="jaxdem.colliders.NeighborList">NeighborList</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/neighbor_list.py#L164-L206"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/neighbor_list.html#NeighborList.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NeighborList.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Returns the cached neighbor list from this collider.</p>
<p>This method does not rebuild the neighbor list. It returns the current
cached <code class="docutils literal notranslate"><span class="pre">neighbor_list</span></code> and <code class="docutils literal notranslate"><span class="pre">overflow</span></code> flag stored in the collider.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Ignored; provided for API compatibility.</p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em>) – Ignored; provided for API compatibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing:
- state: The simulation state.
- system: The simulation system.
- neighbor_list: The cached neighbor list of shape (N, max_neighbors).
- overflow: Boolean flag indicating if the list overflowed during the</p>
<blockquote>
<div><p>last build.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>, jax.Array, jax.Array]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The returned neighbor indices refer to the internal particle ordering
established during the most recent rebuild inside <code class="docutils literal notranslate"><span class="pre">compute_force</span></code>.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/neighbor_list.py#L260-L373"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/neighbor_list.html#NeighborList.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NeighborList.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Computes total forces acting on each particle, rebuilding the neighbor list if necessary.</p>
<p>This method checks if any particle has moved enough to trigger a rebuild
(displacement &gt; skin/2). If so, it invokes the internal spatial partitioner
to refresh the neighbor list. It then sums force contributions using the
cached list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <code class="docutils literal notranslate"><span class="pre">State</span></code> object with computed forces
and the updated <code class="docutils literal notranslate"><span class="pre">System</span></code> object (with refreshed collider cache).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates <code class="docutils literal notranslate"><span class="pre">state</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.NeighborList.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/neighbor_list.py#L375-L420"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/neighbor_list.html#NeighborList.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.NeighborList.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Computes the potential energy associated with each particle using the cached neighbor list.</p>
<p>This method iterates over the cached neighbors for each particle and sums
the potential energy contributions computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One-dimensional array containing the total potential energy contribution for each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jaxdem.colliders.valid_interaction_mask">
<span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.</span></span><span class="sig-name descname"><span class="pre">valid_interaction_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clump_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clump_j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interact_same_bond_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/__init__.py#L135-L150"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders.html#valid_interaction_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.valid_interaction_mask" title="Link to this definition">#</a></dt>
<dd><p>Pair mask shared by all colliders.</p>
<p>Interactions are always disabled for particles in the same clump.
Interactions for particles with equal <code class="docutils literal notranslate"><span class="pre">bond_id</span></code> are controlled by
<code class="docutils literal notranslate"><span class="pre">interact_same_bond_id</span></code>.</p>
</dd></dl>

<p class="rubric">Modules</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.colliders.cell_list.html#module-jaxdem.colliders.cell_list" title="jaxdem.colliders.cell_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell_list</span></code></a></p></td>
<td><p>Cell List <span class="math notranslate nohighlight">\(O(N log N)\)</span> collider implementation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.colliders.naive.html#module-jaxdem.colliders.naive" title="jaxdem.colliders.naive"><code class="xref py py-obj docutils literal notranslate"><span class="pre">naive</span></code></a></p></td>
<td><p>Naive <span class="math notranslate nohighlight">\(O(N^2)\)</span> collider implementation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="jaxdem.colliders.neighbor_list.html#module-jaxdem.colliders.neighbor_list" title="jaxdem.colliders.neighbor_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">neighbor_list</span></code></a></p></td>
<td><p>Neighbor List Collider implementation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="jaxdem.colliders.sweep_and_prune.html#module-jaxdem.colliders.sweep_and_prune" title="jaxdem.colliders.sweep_and_prune"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sweep_and_prune</span></code></a></p></td>
<td><p>Sweep and prune <span class="math notranslate nohighlight">\(O(N log N)\)</span> collider implementation.</p></td>
</tr>
</tbody>
</table>
</div>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="jaxdem.bonded_forces.deformable_particle.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">jaxdem.bonded_forces.deformable_particle</p>
      </div>
    </a>
    <a class="right-next"
       href="jaxdem.colliders.cell_list.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">jaxdem.colliders.cell_list</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.Collider"><code class="docutils literal notranslate"><span class="pre">Collider</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.Collider.compute_force"><code class="docutils literal notranslate"><span class="pre">Collider.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.Collider.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">Collider.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.Collider.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">Collider.create_neighbor_list()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NaiveSimulator"><code class="docutils literal notranslate"><span class="pre">NaiveSimulator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NaiveSimulator.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">NaiveSimulator.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NaiveSimulator.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">NaiveSimulator.create_neighbor_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NaiveSimulator.compute_force"><code class="docutils literal notranslate"><span class="pre">NaiveSimulator.compute_force()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList"><code class="docutils literal notranslate"><span class="pre">StaticCellList</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.neighbor_mask"><code class="docutils literal notranslate"><span class="pre">StaticCellList.neighbor_mask</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.cell_size"><code class="docutils literal notranslate"><span class="pre">StaticCellList.cell_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.max_occupancy"><code class="docutils literal notranslate"><span class="pre">StaticCellList.max_occupancy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.Create"><code class="docutils literal notranslate"><span class="pre">StaticCellList.Create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.compute_force"><code class="docutils literal notranslate"><span class="pre">StaticCellList.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">StaticCellList.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.StaticCellList.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">StaticCellList.create_neighbor_list()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList"><code class="docutils literal notranslate"><span class="pre">DynamicCellList</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList.neighbor_mask"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.neighbor_mask</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList.cell_size"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.cell_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList.Create"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.Create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList.compute_force"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.DynamicCellList.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.create_neighbor_list()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList"><code class="docutils literal notranslate"><span class="pre">NeighborList</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.cell_list"><code class="docutils literal notranslate"><span class="pre">NeighborList.cell_list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.neighbor_list"><code class="docutils literal notranslate"><span class="pre">NeighborList.neighbor_list</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.old_pos"><code class="docutils literal notranslate"><span class="pre">NeighborList.old_pos</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.n_build_times"><code class="docutils literal notranslate"><span class="pre">NeighborList.n_build_times</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.cutoff"><code class="docutils literal notranslate"><span class="pre">NeighborList.cutoff</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.skin"><code class="docutils literal notranslate"><span class="pre">NeighborList.skin</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.overflow"><code class="docutils literal notranslate"><span class="pre">NeighborList.overflow</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.max_neighbors"><code class="docutils literal notranslate"><span class="pre">NeighborList.max_neighbors</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.Create"><code class="docutils literal notranslate"><span class="pre">NeighborList.Create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">NeighborList.create_neighbor_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.compute_force"><code class="docutils literal notranslate"><span class="pre">NeighborList.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.NeighborList.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">NeighborList.compute_potential_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.valid_interaction_mask"><code class="docutils literal notranslate"><span class="pre">valid_interaction_mask()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Carlos Andres del Valle.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>