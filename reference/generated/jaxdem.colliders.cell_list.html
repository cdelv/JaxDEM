
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>jaxdem.colliders.cell_list &#8212; JaxDEM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=039bb74b" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/jaxdem.colliders.cell_list';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="jaxdem.colliders.naive" href="jaxdem.colliders.naive.html" />
    <link rel="prev" title="jaxdem.colliders" href="jaxdem.colliders.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">JaxDEM</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribution_guide/index.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cdelv/JaxDEM" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contribution_guide/index.html">
    Contribution Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cdelv/JaxDEM" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="jaxdem.html">jaxdem</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="jaxdem.analysis.html">jaxdem.analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.bonded_forces.html">jaxdem.bonded_forces</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="jaxdem.colliders.html">jaxdem.colliders</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">jaxdem.colliders.cell_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.naive.html">jaxdem.colliders.naive</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.neighbor_list.html">jaxdem.colliders.neighbor_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxdem.colliders.sweep_and_prune.html">jaxdem.colliders.sweep_and_prune</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.domains.html">jaxdem.domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.factory.html">jaxdem.factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.forces.html">jaxdem.forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.integrators.html">jaxdem.integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.material_matchmakers.html">jaxdem.material_matchmakers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.materials.html">jaxdem.materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.minimizers.html">jaxdem.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.rl.html">jaxdem.rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.state.html">jaxdem.state</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.system.html">jaxdem.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.utils.html">jaxdem.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaxdem.writers.html">jaxdem.writers</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="jaxdem.rl.html">jaxdem.rl</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items" aria-labelledby="pst-indices-navigation-heading-2">
  <p id="pst-indices-navigation-heading-2" class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../../genindex.html"
             accesskey="I">General Index</a>
        </li>
        <li class="toctree-l1">
          <a class="reference internal" href="../../py-modindex.html">Python Module Index</a>
        </li>
  </ul>
</nav></div>
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">API reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="jaxdem.html" class="nav-link">jaxdem</a></li>
    
    
    <li class="breadcrumb-item"><a href="jaxdem.colliders.html" class="nav-link">jaxdem.colliders</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">jaxdem.colliders.cell_list</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-jaxdem.colliders.cell_list">
<span id="jaxdem-colliders-cell-list"></span><h1>jaxdem.colliders.cell_list<a class="headerlink" href="#module-jaxdem.colliders.cell_list" title="Link to this heading">#</a></h1>
<p>Cell List <span class="math notranslate nohighlight">\(O(N log N)\)</span> collider implementation.</p>
<p class="rubric">Classes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#jaxdem.colliders.cell_list.DynamicCellList" title="jaxdem.colliders.cell_list.DynamicCellList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DynamicCellList</span></code></a>(neighbor_mask, cell_size)</p></td>
<td><p>Implicit cell-list (spatial hashing) collider using dynamic while-loops.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jaxdem.colliders.cell_list.StaticCellList" title="jaxdem.colliders.cell_list.StaticCellList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StaticCellList</span></code></a>(neighbor_mask, cell_size, ...)</p></td>
<td><p>Implicit cell-list (spatial hashing) collider.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.cell_list.</span></span><span class="sig-name descname"><span class="pre">StaticCellList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_occupancy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.colliders.html#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collider</span></code></a></p>
<p>Implicit cell-list (spatial hashing) collider.</p>
<p>This collider accelerates short-range pair interactions by partitioning the
domain into a regular grid of cubic/square cells of side length <code class="docutils literal notranslate"><span class="pre">cell_size</span></code>.
Each particle is assigned to a cell, particles are sorted by cell hash, and
interactions are evaluated only against particles in the same or neighboring
cells given by <code class="docutils literal notranslate"><span class="pre">neighbor_mask</span></code>. The cell list is <em>implicit</em> because we never
store per-cell particle lists explicitly; instead, we exploit the sorted hashes
and fixed <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> to probe neighbors in-place.</p>
<p>This collider is ideal for systems of spheres with minimum polydispersity and no dramatic overlaps.
In this case, it might be even faster than the default cell list. However, it’s not recommended for systems
with clumps, dramatic overlaps, as it might skip some contacts, or polydispersity, as it hinders the performance of this collider.</p>
<section id="complexity">
<h2>Complexity<a class="headerlink" href="#complexity" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Time: <span class="math notranslate nohighlight">\(O(N)\)</span> - <span class="math notranslate nohighlight">\(O(N \log N)\)</span> from sorting, plus <span class="math notranslate nohighlight">\(O(N M K)\)</span> for neighbor
probing (M = number of neighbor cells, K = <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code>). The state is close to sorted every frame.</p></li>
<li><p>Memory: <span class="math notranslate nohighlight">\(O(N)\)</span>.</p></li>
</ul>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> is an upper bound on particles per cell.
If a cell contains more than this many particles, some interactions
might be missed (you should choose <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> so this does not happen).</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.neighbor_mask">
<span class="sig-name descname"><span class="pre">neighbor_mask</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.neighbor_mask" title="Link to this definition">#</a></dt>
<dd><p>Integer offsets defining the neighbor stencil.</p>
<p>Shape is <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">dim)</span></code>, where each row is a displacement in cell coordinates.
For <code class="docutils literal notranslate"><span class="pre">search_range=1</span></code> in 2D this is the 3×3 Moore neighborhood (M=9);
in 3D this is the 3×3×3 neighborhood (M=27).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.cell_size">
<span class="sig-name descname"><span class="pre">cell_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.cell_size" title="Link to this definition">#</a></dt>
<dd><p>Linear size of a grid cell (scalar).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.max_occupancy">
<span class="sig-name descname"><span class="pre">max_occupancy</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.max_occupancy" title="Link to this definition">#</a></dt>
<dd><p>Maximum number of particles assumed to occupy a single cell.</p>
<p>The algorithm probes exactly <code class="docutils literal notranslate"><span class="pre">max_occupancy</span></code> entries starting from the
first particle in a neighbor cell. This should be set high enough that
real cells rarely exceed it; otherwise contacts/energy will be undercounted.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.Create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_occupancy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L559-L671"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.Create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.Create" title="Link to this definition">#</a></dt>
<dd><p>Creates a StaticCellList collider with robust defaults.</p>
<p>Defaults are chosen to avoid missing any contacts while keeping the
neighbor stencil and assumed cell occupancy as small as possible given
available information from <code class="docutils literal notranslate"><span class="pre">state</span></code>. For this we assume no overlap between spheres.</p>
<p>The cost of computing forces for one particle is determined by the number
of neighboring cells to check and the occupancy of each cell. This cost
can be estimated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{cost} = (2R + 1)^{dim} \cdot \text{max_occupancy} \\
\text{cost} = (2R + 1)^{dim} \cdot \left(\left\lceil \frac{L^{dim}}{V_{min}} \right\rceil +2 \right)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the search radius, <span class="math notranslate nohighlight">\(L\)</span> is the cell size, and
<span class="math notranslate nohighlight">\(V_{min}\)</span> is the volume of the smallest element. We assume
<span class="math notranslate nohighlight">\(V_{min}\)</span> to be the volume of the smallest sphere, without
accounting for the packing fraction, to provide a conservative upper bound.
The search radius <span class="math notranslate nohighlight">\(R\)</span> is computed as:</p>
<div class="math notranslate nohighlight">
\[R = \left\lceil \frac{2 r_{max}}{L} \right\rceil\]</div>
<p>By default, we choose the options that yield the lowest computational
cost: <span class="math notranslate nohighlight">\(L = 2 \cdot r_{max}\)</span> if <span class="math notranslate nohighlight">\(\alpha &lt; 2.5\)</span>, else <span class="math notranslate nohighlight">\(L = r_{max}/2\)</span>.</p>
<p>The complexity of searching neighbors is <span class="math notranslate nohighlight">\(O(N)\)</span>, where the choice
of cell size and <span class="math notranslate nohighlight">\(R\)</span> attempts to minimize the constant factor. The constant factor
grows with polydispersity (<span class="math notranslate nohighlight">\(\alpha\)</span>) as <span class="math notranslate nohighlight">\(O(\alpha^{dim})\)</span> with <span class="math notranslate nohighlight">\(\alpha = r_{max}/r_{min}\)</span>.
The cost for sorting and binary search remains <span class="math notranslate nohighlight">\(O(N \log N)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Reference state used to determine spatial dimension and default parameters.</p></li>
<li><p><strong>cell_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Cell edge length. If None, defaults to a value optimized for the
radius distribution.</p></li>
<li><p><strong>search_range</strong> (<em>int</em><em>, </em><em>optional</em>) – Neighbor range in cell units. If None, the smallest safe value is
computed such that <span class="math notranslate nohighlight">\(\text{search\_range} \cdot L \geq \text{cutoff}\)</span>.</p></li>
<li><p><strong>box_size</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Size of the periodic box used to ensure there are at least
<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">search_range</span> <span class="pre">+</span> <span class="pre">1</span></code> cells per axis. If None, these checks are
skipped.</p></li>
<li><p><strong>max_occupancy</strong> (<em>int</em><em>, </em><em>optional</em>) – Assumed maximum particles per cell. If None, estimated from a
conservative packing upper bound using the smallest radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured collider instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CellList</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L673-L706"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Computes the total force acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the force contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code> and updates the particle forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <code class="docutils literal notranslate"><span class="pre">State</span></code> object with computed forces and the unmodified <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates <code class="docutils literal notranslate"><span class="pre">state</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L708-L735"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Computes the potential energy acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the energy contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array containing the potential energy for each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.StaticCellList.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L737-L822"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#StaticCellList.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.StaticCellList.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Computes the list of neighbors for each particle. The shape of the list is (N, max_neighbors).
If a particle has less neighbors than max_neighbors, the list is padded with -1. The indices of the list
correspond to the indices of the returned sorted state.</p>
<p>Note that no neighbors further than cell_size * (1 + search_range) (how many neighbors to check in the cells)
can be found due to the nature of the cell list. If cutoff is greater than this value, the list might not
return the expected list. Note that if a cell contains more spheres than those specified in max_occupancy, there might be missing neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Search radius</p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em>) – Maximum number of neighbors to store per particle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sorted state, the system, the neighbor list, and a boolean flag for overflow.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jaxdem.colliders.cell_list.</span></span><span class="sig-name descname"><span class="pre">DynamicCellList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbor_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="jaxdem.colliders.html#jaxdem.colliders.Collider" title="jaxdem.colliders.Collider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collider</span></code></a></p>
<p>Implicit cell-list (spatial hashing) collider using dynamic while-loops.</p>
<p>This collider accelerates short-range pair interactions by partitioning the
domain into a regular grid. Unlike the static cell list, this implementation
uses a dynamic <code class="docutils literal notranslate"><span class="pre">jax.lax.while_loop</span></code> to probe neighbor cells, which can be
more efficient with polydisperse systems or low packing fractions. It’s also useful for systems that
have a high occupancy per cell, for example, systems with clumps.</p>
<section id="id1">
<h2>Complexity<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Time: <span class="math notranslate nohighlight">\(O(N)\)</span> - <span class="math notranslate nohighlight">\(O(N \log N)\)</span> from sorting, plus <span class="math notranslate nohighlight">\(O(N M \langle K \rangle)\)</span>
for neighbor probing, where <span class="math notranslate nohighlight">\(\langle K \rangle\)</span> is the average cell occupancy. The state is close to sorted every frame.</p></li>
<li><p>Memory: <span class="math notranslate nohighlight">\(O(N)\)</span>.</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList.neighbor_mask">
<span class="sig-name descname"><span class="pre">neighbor_mask</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList.neighbor_mask" title="Link to this definition">#</a></dt>
<dd><p>Integer offsets defining the neighbor stencil (M, dim).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList.cell_size">
<span class="sig-name descname"><span class="pre">cell_size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList.cell_size" title="Link to this definition">#</a></dt>
<dd><p>Linear size of a grid cell (scalar).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList.Create">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">Create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L851-L945"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.Create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList.Create" title="Link to this definition">#</a></dt>
<dd><p>Creates a CellList collider with robust defaults.</p>
<p>Defaults are chosen to avoid missing any contacts while keeping the
neighbor stencil and assumed cell occupancy as small as possible given
available information from <code class="docutils literal notranslate"><span class="pre">state</span></code>.</p>
<p>The cost of computing forces for one particle is determined by the number
of neighboring cells to check and the occupancy of each cell. This cost
can be estimated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{cost} = (2R + 1)^{dim} \cdot \text{max_occupancy} \\
\text{cost} = (2R + 1)^{dim} \cdot \left(\left\lceil \frac{L^{dim}}{V_{min}} \right\rceil +2 \right)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the search radius, <span class="math notranslate nohighlight">\(L\)</span> is the cell size, and
<span class="math notranslate nohighlight">\(V_{min}\)</span> is the volume of the smallest element. We assume
<span class="math notranslate nohighlight">\(V_{min}\)</span> to be the volume of the smallest sphere, without
accounting for the packing fraction, to provide a conservative upper bound.
The search radius <span class="math notranslate nohighlight">\(R\)</span> is computed as:</p>
<div class="math notranslate nohighlight">
\[R = \left\lceil \frac{2 r_{max}}{L} \right\rceil\]</div>
<p>By default, we choose the options that yield the lowest computational cost: <span class="math notranslate nohighlight">\(L = 2 \cdot r_{max}\)</span> if <span class="math notranslate nohighlight">\(\alpha &lt; 2.5\)</span>, else <span class="math notranslate nohighlight">\(L = r_{max}/2\)</span>.</p>
<p>The complexity of searching neighbors is <span class="math notranslate nohighlight">\(O(N)\)</span>, where the choice
of cell size and <span class="math notranslate nohighlight">\(R\)</span> attempts to minimize the constant factor. The constant factor
grows with polydispersity; however, the dynamic nature of the collider greatly minimizes polydispersity’s impact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – Reference state used to determine spatial dimension and default parameters.</p></li>
<li><p><strong>cell_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Cell edge length. If None, defaults to a value optimized for the
radius distribution.</p></li>
<li><p><strong>box_size</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Size of the periodic box used to ensure there are at least 3 cells per axis.
If None, these checks are ignored and will lead to errors if violated.</p></li>
<li><p><strong>search_range</strong> (<em>int</em><em>, </em><em>optional</em>) – Neighbor range in cell units. If None, the smallest safe value is
computed such that <span class="math notranslate nohighlight">\(\text{search\_range} \cdot L \geq \text{cutoff}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured collider instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CellList</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList.compute_force">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L947-L982"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.compute_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList.compute_force" title="Link to this definition">#</a></dt>
<dd><p>Computes the total force acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the force contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code> and updates the particle forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated <code class="docutils literal notranslate"><span class="pre">State</span></code> object with computed forces and the unmodified <code class="docutils literal notranslate"><span class="pre">System</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method donates <code class="docutils literal notranslate"><span class="pre">state</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList.compute_potential_energy">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_potential_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L984-L1011"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.compute_potential_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList.compute_potential_energy" title="Link to this definition">#</a></dt>
<dd><p>Computes the potential energy acting on each particle using an implicit cell list <span class="math notranslate nohighlight">\(O(N log N)\)</span>.
This method sums the energy contributions from all particle pairs (i, j)
as computed by the <code class="docutils literal notranslate"><span class="pre">system.force_model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array containing the potential energy for each particle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jaxdem.colliders.cell_list.DynamicCellList.create_neighbor_list">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">create_neighbor_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><span class="pre">System</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/cdelv/JaxDEM/blob/main/jaxdem/colliders/cell_list.py#L1013-L1135"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference internal" href="../../_modules/jaxdem/colliders/cell_list.html#DynamicCellList.create_neighbor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jaxdem.colliders.cell_list.DynamicCellList.create_neighbor_list" title="Link to this definition">#</a></dt>
<dd><p>Computes the list of neighbors for each particle. The shape of the list is (N, max_neighbors).
If a particle has less neighbors than max_neighbors, the list is padded with -1. The indices of the list
correspond to the indices of the returned sorted state.</p>
<p>Note that no neighbors further than cell_size * (1 + search_range) (how many neighbors to check in the cells)
can be found due to the nature of the cell list. If cutoff is greater than this value, the list might not
return the expected list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State"><em>State</em></a>) – The current state of the simulation.</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System"><em>System</em></a>) – The configuration of the simulation.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Search radius</p></li>
<li><p><strong>max_neighbors</strong> (<em>int</em>) – Maximum number of neighbors to store per particle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sorted state, the system, the neighbor list, and a boolean flag for overflow.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<a class="reference internal" href="jaxdem.html#jaxdem.State" title="jaxdem.State">State</a>, <a class="reference internal" href="jaxdem.html#jaxdem.System" title="jaxdem.System">System</a>, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="jaxdem.colliders.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">jaxdem.colliders</p>
      </div>
    </a>
    <a class="right-next"
       href="jaxdem.colliders.naive.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">jaxdem.colliders.naive</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList"><code class="docutils literal notranslate"><span class="pre">StaticCellList</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.neighbor_mask"><code class="docutils literal notranslate"><span class="pre">StaticCellList.neighbor_mask</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.cell_size"><code class="docutils literal notranslate"><span class="pre">StaticCellList.cell_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.max_occupancy"><code class="docutils literal notranslate"><span class="pre">StaticCellList.max_occupancy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.Create"><code class="docutils literal notranslate"><span class="pre">StaticCellList.Create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.compute_force"><code class="docutils literal notranslate"><span class="pre">StaticCellList.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">StaticCellList.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.StaticCellList.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">StaticCellList.create_neighbor_list()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList"><code class="docutils literal notranslate"><span class="pre">DynamicCellList</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList.neighbor_mask"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.neighbor_mask</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList.cell_size"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.cell_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList.Create"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.Create()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList.compute_force"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.compute_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList.compute_potential_energy"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.compute_potential_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jaxdem.colliders.cell_list.DynamicCellList.create_neighbor_list"><code class="docutils literal notranslate"><span class="pre">DynamicCellList.create_neighbor_list()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Carlos Andres del Valle.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>